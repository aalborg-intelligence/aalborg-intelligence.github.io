<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Vi skal i dette forløb snuse til, hvad kunstig intelligens er for noget. Vi tager udgangspunkt i lineære funktioner af både én og to variable. Vi slutter af med at træne et simpelt kunstigt neuralt netværk i et eksempel, som handler om, at kunne forudsige om en person lever bæredygtigt eller ej baseret på svarene på en række spørgsmål.">

<title>Lever du bæredygtigt? – AI MAT - matematikken bag magien</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../logo/SVG/Bomaerke_05_AIMAT_2024.svg" rel="icon" type="image/svg+xml">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dc55a5b9e770e841cd82e46aadbfb9b0.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-a56cede0eac73c8a8bcab8be466c7faa.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-Y219BCPS45"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
 
  gtag('consent', 'default', {
    'ad_storage': 'denied',
    'analytics_storage': 'denied'
  });
gtag('config', 'G-Y219BCPS45', { 'anonymize_ip': true});
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="floating nav-fixed slimcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../logo/PNG/Logo_multi_AIMAT_RGB_2024.png" alt="" class="navbar-logo light-content">
    <img src="../logo/PNG/Logo_multi_AIMAT_RGB_2024.png" alt="" class="navbar-logo dark-content">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../undervisningsforlob/index.html"> 
<span class="menu-text">Undervisningsforløb</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../materialer/index.html"> 
<span class="menu-text">Materialer</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../srp/index.html"> 
<span class="menu-text">SRP</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../apps/index.html"> 
<span class="menu-text">Apps</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">Om os</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.youtube.com/@ai-mat"> 
<span class="menu-text"><img src="../logo/YouTube/youtube-color-darkblue-icon.svg" style="height:2em"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Indhold</h2>
   
  <ul>
  <li><a href="#formål" id="toc-formål" class="nav-link active" data-scroll-target="#formål">Formål</a></li>
  <li><a href="#funktioner" id="toc-funktioner" class="nav-link" data-scroll-target="#funktioner">Funktioner</a></li>
  <li><a href="#neurale-net" id="toc-neurale-net" class="nav-link" data-scroll-target="#neurale-net">Neurale net</a></li>
  <li><a href="#toppunkt-for-en-parabel" id="toc-toppunkt-for-en-parabel" class="nav-link" data-scroll-target="#toppunkt-for-en-parabel">Toppunkt for en parabel</a></li>
  <li><a href="#bedste-rette-linje" id="toc-bedste-rette-linje" class="nav-link" data-scroll-target="#bedste-rette-linje">Bedste rette linje</a></li>
  <li><a href="#træning-af-neurale-net" id="toc-træning-af-neurale-net" class="nav-link" data-scroll-target="#træning-af-neurale-net">Træning af neurale net</a></li>
  <li><a href="#anvendelse-lever-du-bæredygtigt" id="toc-anvendelse-lever-du-bæredygtigt" class="nav-link" data-scroll-target="#anvendelse-lever-du-bæredygtigt">Anvendelse: Lever du bæredygtigt?</a></li>
  <li><a href="#brug-af-kunstig-intelligens" id="toc-brug-af-kunstig-intelligens" class="nav-link" data-scroll-target="#brug-af-kunstig-intelligens">Brug af kunstig intelligens</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lever du bæredygtigt?</h1>
  <div class="quarto-categories">
    <div class="quarto-category">B-niveau</div>
    <div class="quarto-category">Kort</div>
  </div>
  </div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="callout callout-style-simple callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Caution</span>Forudsætninger og tidsforbrug
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Forløbet kræver kendskab til:</p>
<ul>
<li>Lineære funktioner.</li>
<li>Bedste rette linje (lineær regression).</li>
<li>Andengradspolynomier.</li>
</ul>
<p><strong>Tidsforbrug:</strong> Ca. 1-2 x 90 minutter.</p>
</div>
</div>
</div>
<section id="formål" class="level3 purpose">
<h3 class="anchored" data-anchor-id="formål">Formål</h3>
<p>Vi skal i dette forløb snuse til, hvad kunstig intelligens er for noget. Vi tager udgangspunkt i lineære funktioner af både én og to variable. Dernæst skal vi se på, hvordan man finder toppunktet for en parabel med en såkaldt <em>iterativ</em> metode. Herefter skal vi se, hvordan denne metode kan bruges til at finde bedste rette linje. Endelig slutter vi af med at træne et simpelt kunstigt neuralt netværk i et eksempel, som handler om at kunne forudsige, om en person lever bæredygtigt eller ej baseret på svarene på en række spørgsmål.</p>
</section>
<section id="funktioner" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="funktioner">Funktioner</h2>
<p>Vi starter med at se på funktioner, som vi kender dem.</p>
<p>Et taxafirma – lad os kalde det "Taxa1" – tager <span class="math inline">\(10\)</span> kroner for hver kørt kilometer. Prisens afhængighed af afstanden kan så beskrives med formlen: <span class="math display">\[
        \textrm{Pris} = \textrm{Afstand} \cdot  10
\]</span> hvor afstanden måles i kilometer, og prisen fås i kroner. Situationen kan illustreres, som vist i <a href="#fig-taxa1" class="quarto-xref">figur&nbsp;1</a>.</p>
<div id="fig-taxa1" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-taxa1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lever_du_baeredygtigt/images/taxa1.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-taxa1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figur&nbsp;1: Illustration af hvordan prisen for "Taxa1" kan beregnes ved hjælp af afstanden.
</figcaption>
</figure>
</div>
<p>Et andet taxafirma – lad os kalde det "Taxa2" – tager kun <span class="math inline">\(5\)</span> kroner for hver kørt kilometer, men tager så desuden <span class="math inline">\(3\)</span> kroner for hvert minut turen tager. Prisens afhængighed af både afstand og tid kan så beskrives med formlen: <span class="math display">\[
        \textrm{Pris} = \textrm{Afstand} \cdot 5  +  \textrm{Tid} \cdot 3
\]</span> hvor afstanden måles i kilometer, tiden måles i minutter og prisen fås i kroner. Det kan illusteres sådan her:</p>
<div id="fig-taxa2" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-taxa2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lever_du_baeredygtigt/images/taxa2.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-taxa2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figur&nbsp;2: Illustration af hvordan prisen for "Taxa2" kan beregnes ved hjælp af afstanden og tiden.
</figcaption>
</figure>
</div>
<p>Det brugte input kaldes de uafhængige variable, det beregnede output kaldes den afhængige variabel og sammenhængen, der beskriver, hvordan output afhænger af input, kalder vi en funktion.</p>
<p>For "Taxa1" er prisen en funktion af én variabel – afstanden – og tallet <span class="math inline">\(10\)</span> er en parameter, der bruges til at fastlægge funktionen.</p>
<p>For "Taxa2" er prisen en funktion af to variable – afstand og tid – og tallene <span class="math inline">\(3\)</span> og <span class="math inline">\(5\)</span> er parametre, der bruges til at fastlægge funktionen.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Opgave 1: "Taxa1"
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li>Beregn prisen for at køre <span class="math inline">\(6\)</span> kilometer med firmaet "Taxa1".</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Opgave 2: "Taxa2"
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li>Beregn prisen for at køre <span class="math inline">\(6\)</span> kilometer med firmaet "Taxa2", hvis turen tager <span class="math inline">\(12\)</span> minutter.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Opgave 3: Sammenligning
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><p>Beregn gennemsnitsfarten for turen i opgave 2.</p></li>
<li><p>Overvej, om man kan sige noget om, hvornår det bedst kan betale sig at bruge henholdsvis "Taxa1" og "Taxa2".</p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="neurale-net" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="neurale-net">Neurale net</h2>
<p>Inden for kunstig intelligens får man brug for nogle mere komplicerede funktioner, end dem vi så i taxaeksemplet, nemlig de såkaldte kunstige neurale net. Et kunstigt neuralt net forsøger at efterligne hjernen med et antal hjerneceller (neuroner) og forbindelser mellem dem. Man kan illustrere det således:</p>
<div id="fig-NN_simple" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-NN_simple-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lever_du_baeredygtigt/images/NN_simple.png" class="img-fluid figure-img" style="width:75.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-NN_simple-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figur&nbsp;3: Illustration af et simpelt neuralt netværk.
</figcaption>
</figure>
</div>
<p>Idéen er, at man sender nogle inputvariable ind i nettet (vist som de mørkeblå cirkler til venstre i <a href="#fig-NN_simple" class="quarto-xref">figur&nbsp;3</a>), hvor der sker nogle beregninger (de grønne cirkler i midten). Herefter returnerer netværket én eller flere outputværdier (vist som de lyserøde cirkler til højre).</p>
<p>Det kan være meget mere kompliceret, end det vi har vist i <a href="#fig-NN_simple" class="quarto-xref">figur&nbsp;3</a> – med mange flere knudepunkter i mange lag og med mange forbindelser.</p>
<p>Uanset om input er tal, tekster, billeder, film eller andet, så bliver det altid oversat til et antal tal, så der kan sendes et tal til hvert knudepunkt i inputlaget.</p>
<p>Alle forbindelserne har tilknyttet en parameter (også kaldet en vægt), som bliver ganget på tallet, inden det bliver sendt videre. Det samlede input til et knudepunkt er i det mest simple tilfælde summen af de sendte bidrag fra knudepunkterne i laget før<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;Ofte anvender man også en såkaldt aktiveringsfunktion. Det kan du læse mere om <a href="../undervisningsforlob/aktiveringsfunktioner.html">her</a>.</p></div></div><p>Til sidst ender man med et tal i hvert knudepunkt i outputlaget, som så kan oversættes tilbage til tal, tekster, billeder, film eller andet.</p>
<p>Bemærk, at alle vægtene knyttet til forbindelserne mellem knudepunkterne fastlægger den funktion, som beskriver hvordan output afhænger af input.</p>
<p>Vi kan illustrere funktionen fra "Taxa2" med samme billede, hvor en konkret taxatur bliver oversat til to tal: afstand og tid. Det er vist i <a href="#fig-NN_taxa2" class="quarto-xref">figur&nbsp;4</a>.</p>
<div id="fig-NN_taxa2" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-NN_taxa2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lever_du_baeredygtigt/images/NN_taxa2.png" class="img-fluid figure-img" style="width:75.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-NN_taxa2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figur&nbsp;4: Et lille neuralt netværk som illustrerer den funktion, som kan udregne prisen for en taxatur med "Taxa2".
</figcaption>
</figure>
</div>
<p>For at få et velfungerende neuralt net skal man altså forsøge at vælge disse vægte, så man får det ønskede output. Det gøres i en iterativ proces, hvor man gradvist træner det neurale net ved hjælp af store mængder træningsdata.</p>
<p>De næste to eksempler <a href="../undervisningsforlob/lever_du_baeredygtigt.html#toppunkt-for-en-parabel">Toppunkt for en parabel</a> og <a href="../undervisningsforlob/lever_du_baeredygtigt.html#bedste-rette-linje">Bedste rette linje</a> skal illustrere metoderne bag den iterative proces, der bruges til at træne neurale net.</p>
<p>Det man gør, når man træner et neuralt net til et datasæt, svarer til det, man gør, når man finder bedste rette linje for et sæt af datapunkter. I afsnittet <a href="#bedste-rette-linje">Bedste rette linje</a> ser vi, hvordan den iterative metode virker i dette tilfælde. Inden da forklares den iterative metode i afsnittet <a href="#toppunkt-for-en-parabel">Toppunkt for en parabel</a>.</p>
</section>
<section id="toppunkt-for-en-parabel" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="toppunkt-for-en-parabel">Toppunkt for en parabel</h2>
<p>Formålet i det første eksempel her er at finde gode tilnærmede bud til <span class="math inline">\(x\)</span>-koordinaten i toppunktet for en parabel. Det er her en vigtig pointe, at vi <em>ikke</em> bruger de eksakte formler, der jo faktisk findes. På den måde kan vi illustrere den iterative proces i et tilfælde, hvor vi kender den eksakte løsning.</p>
<p>Grafen for et andengradspolynomium er en parabel, og hvis tallet foran <span class="math inline">\(x^2\)</span> er positivt, vender grenene opad. Toppunktets <span class="math inline">\(x\)</span>-værdi er derfor den <span class="math inline">\(x\)</span>-værdi (<span class="math inline">\(x_T\)</span>), der giver den mindst mulige <span class="math inline">\(y\)</span>-værdi (<span class="math inline">\(y_T\)</span>). Se <a href="#fig-toppunkt" class="quarto-xref">figur&nbsp;5</a>.</p>
<div id="fig-toppunkt" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-toppunkt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lever_du_baeredygtigt/images/toppunkt.png" class="img-fluid figure-img" style="width:75.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-toppunkt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figur&nbsp;5: Toppunktet for en parabel hvor grenene vender opad.
</figcaption>
</figure>
</div>
<p>Når vi ønsker at finde toppunktets <span class="math inline">\(x\)</span>-værdi med en iterativ proces, vil vi tænke på parablen som en bakke, hvor vi ønsker at komme ned i bunden af bakken til minimum. Det kan vi gøre på følgende måde:</p>
<ul>
<li><p>Vælg en tilfældig <span class="math inline">\(x\)</span>-værdi (<span class="math inline">\(x_{start}\)</span>) og udregn den tilhørende <span class="math inline">\(y\)</span>-værdi (<span class="math inline">\(y_{start}\)</span>) – det svarer til, at vi stiller os et tilfældigt sted på bakken.</p></li>
<li><p>Det er næppe den rigtige <span class="math inline">\(x\)</span>-værdi for toppunktet, men vi kan komme tættere på den rigtige værdi ved enten at skrue lidt op for <span class="math inline">\(x\)</span> eller lidt ned for <span class="math inline">\(x\)</span> for at gå ned ad bakken mod minimum.</p></li>
<li><p>Vi afgør om vi skal skrue op eller ned for <span class="math inline">\(x\)</span> ved at udregne en <span class="math inline">\(y\)</span>-værdi (<span class="math inline">\(y_{ny}\)</span>) for en <span class="math inline">\(x\)</span>-værdi (<span class="math inline">\(x_{ny}\)</span>), der er lidt større end den valgte, og sammenligne den med <span class="math inline">\(y_{start}\)</span>.</p></li>
<li><p>Får vi en større <span class="math inline">\(y\)</span>-værdi, så er vi på vej væk fra minimum, og vi skal derfor skrue lidt ned for <span class="math inline">\(x\)</span>. Se <a href="#fig-toppunkt_larger_y" class="quarto-xref">figur&nbsp;6</a>.</p></li>
</ul>
<div id="fig-toppunkt_larger_y" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-toppunkt_larger_y-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lever_du_baeredygtigt/images/toppunkt_larger_y.png" class="img-fluid figure-img" style="width:75.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-toppunkt_larger_y-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figur&nbsp;6: I den nye <span class="math inline">\(x\)</span>-værdi er <span class="math inline">\(y\)</span>-værdien blevet større. Vi skal derfor skrue ned for <span class="math inline">\(x\)</span> i stedet for at skrue op.
</figcaption>
</figure>
</div>
<ul>
<li>Får vi en mindre <span class="math inline">\(y\)</span>-værdi, så er vi på vej hen mod minimum, og vi skal derfor skrue lidt op for <span class="math inline">\(x\)</span>. Se <a href="#fig-toppunkt_smaller_y" class="quarto-xref">figur&nbsp;7</a>.</li>
</ul>
<div id="fig-toppunkt_smaller_y" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-toppunkt_smaller_y-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lever_du_baeredygtigt/images/toppunkt_smaller_y.png" class="img-fluid figure-img" style="width:75.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-toppunkt_smaller_y-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figur&nbsp;7: I den nye <span class="math inline">\(x\)</span>-værdi er <span class="math inline">\(y\)</span>-værdien blevet mindre. Vi skal derfor skrue op for <span class="math inline">\(x\)</span>.
</figcaption>
</figure>
</div>
<p>Vi gentager nu processen indtil en tilfredsstillende præcision er opnået. Vi kan vælge at tage mindre skridt, når vi tror, at vi er tæt på toppunktet. Det kan vi se, når de to beregnede <span class="math inline">\(y\)</span>-værdier er ret ens.</p>
<p>Lad os se på et eksempel.</p>
<div class="example">
<p><strong>Eksempel 1: Iterativ bestemmelse af toppunkt</strong></p>
<p>Vi ser på andengradspolynomiet med forskrift</p>
<p><span class="math display">\[
f(x)=2x^2-20x+55
\]</span> Vi starter med at gætte på en <span class="math inline">\(x\)</span>-værdi på <span class="math inline">\(4\)</span>:</p>
<p><span class="math display">\[
x_{start} = 4
\]</span> Vi skruer lidt op for <span class="math inline">\(x\)</span>-værdien:</p>
<p><span class="math display">\[
x_{ny} = 4.2
\]</span></p>
<p>Den størrelse, som vi lader <span class="math inline">\(x\)</span>-værdien vokse med, kaldes for <strong>skridtlængden</strong>. Her har vi altså valgt en skridtlængde på <span class="math inline">\(0.2\)</span>.</p>
<p>Vi beregner funktionsværdier:</p>
<p><span class="math display">\[
\begin{aligned}
f(4) &amp;= 7 \\
f(4.2) &amp;= 6.28
\end{aligned}
\]</span></p>
<p>Da <span class="math inline">\(y\)</span>-værdien er blevet mindre ved at skrue op for <span class="math inline">\(x\)</span>, vælger vi at skrue op for <span class="math inline">\(x\)</span>. Vi sætter derfor</p>
<p><span class="math display">\[
\begin{aligned}
x_{start} &amp;= 4.2 \\
x_{ny} &amp;= 4.4
\end{aligned}
\]</span></p>
<p>og udregner funktionsværdier</p>
<p><span class="math display">\[
\begin{aligned}
f(4.2) &amp;= 6.28 \\
f(4.4) &amp;= 5.72 \\
\end{aligned}
\]</span></p>
<p>Da <span class="math inline">\(y\)</span>-værdien igen er blevet mindre ved at skrue op for <span class="math inline">\(x\)</span>, vælger vi at skrue op for <span class="math inline">\(x\)</span>.</p>
<p>Sådan fortsætter vi med enten af skrue op eller ned for <span class="math inline">\(x\)</span>, indtil de to beregnede funktionsværdier er ret ens.</p>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Opgave 4: Iterativ metode
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><p>Regn selv videre på eksemplet ovenfor og bestem på den måde et godt bud på <span class="math inline">\(x\)</span>-koordinaten i toppunktet.</p>
<p><em>OBS! Lad her være med at bruge jeres egen lettere metode. Opgaven skal illustrere en iterativ proces brugt i en situation, hvor en sådan lettere metode ikke findes.</em></p></li>
<li><p>Brug nu toppunktsformlen til at udregne <span class="math inline">\(x\)</span>-koordinaten i toppunktet. Hvor tæt kom du på det rigtige svar, da du brugte den iterative metode?</p></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Opgave 5: Iterativ metode
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><p>Brug samme metode som i opgave 4, men med jeres eget startgæt og skridtlængde til at bestemme et godt bud på <span class="math inline">\(x\)</span>-koordinaten i toppunktet for andengradspolynomiet med forskrift <span class="math inline">\(f(x)=x^2-4x+11\)</span>.</p></li>
<li><p>Kontroller til sidst dit resultat ved at bruge toppunktsformlen.</p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="bedste-rette-linje" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="bedste-rette-linje">Bedste rette linje</h2>
<p>I dette eksempel vil vi finde tallene <span class="math inline">\(a\)</span> og <span class="math inline">\(b\)</span> for den bedste rette linje <span class="math inline">\(y=ax+b\)</span>. Det er igen her en vigtig pointe, at vi <em>ikke</em> bruger de eksakte formler, der jo faktisk findes. På den måde kan vi igen illustrere den iterative proces i et tilfælde, hvor vi kender den eksakte løsning.</p>
<p>Når vi laver lineær regression, finder vi den rette linje, som "bedst" beskriver en række målepunkter. Vi skal her starte med at se nærmere på, hvad vi egentlig mener med "bedst".</p>
<p>Vi forestiller os en måleserie bestående af fem punkter:</p>
<table class="table-bordered table">
<thead>
<tr class="header">
<th style="text-align: center;"><span class="math inline">\(x_1\)</span></th>
<th style="text-align: center;"><span class="math inline">\(x_2\)</span></th>
<th style="text-align: center;"><span class="math inline">\(x_3\)</span></th>
<th style="text-align: center;"><span class="math inline">\(x_4\)</span></th>
<th style="text-align: center;"><span class="math inline">\(x_5\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(y_1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(y_2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(y_3\)</span></td>
<td style="text-align: center;"><span class="math inline">\(y_4\)</span></td>
<td style="text-align: center;"><span class="math inline">\(y_5\)</span></td>
</tr>
</tbody>
</table>
<p>I <a href="#fig-bedste_rette_linje1" class="quarto-xref">figur&nbsp;8</a> har vi indtegnet et eksempel på sådanne fem punkter og en ret linje med ligning</p>
<p><span class="math display">\[
y = ax + b
\]</span></p>
<div id="fig-bedste_rette_linje1" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-bedste_rette_linje1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lever_du_baeredygtigt/images/bedste_rette_linje_illustration1.png" class="img-fluid figure-img" style="width:75.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-bedste_rette_linje1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figur&nbsp;8: Fem punkter og en ret linje, hvor den lodrette afstand fra hvert punkt ned til linjen er markeret.
</figcaption>
</figure>
</div>
<p>Desuden har vi indtegnet den lodrette afstand fra hvert af de fem punkter ned til linjen. Afstanden <span class="math inline">\(r_1\)</span> fra det første punkt <span class="math inline">\((x_1,y_1)\)</span> ned til linjen beregnes sådan her:</p>
<p><span class="math display">\[
r_1 = y_1 - (ax_1+b)
\]</span></p>
<p>På tilsvarende vis beregnes de andre afstande.</p>
<p>I princippet vil vi gerne finde den rette linje, hvor alle disse afstande til sammen er så lille som mulig. Nu vil det bare være sådan, at hvis punktet ligger over linjen, så vil afstanden være positiv, mens hvis punkterne ligger under linjen, så vil afstanden være negativ. Man kan derfor ikke bare lægge alle afstandene sammen, fordi man kan ende på en sum, som er tæt på <span class="math inline">\(0\)</span> uden, at linjen måske er specielt god. For at slippe af med de negative afstande sætter man alle afstande i anden og ser derfor på den kvadrerede sum:</p>
<p><span class="math display">\[
r_1^2 + r_2^2 + r_3^2 + r_4^2 + r_5^2
\]</span></p>
<p>På <a href="#fig-bedste_rette_linje2" class="quarto-xref">figur&nbsp;9</a> er denne kvadratsum illustreret. Hvis man ellers har de samme enheder på akserne, vil hver af de fem kvadrerede afstande svare til arealet af de kvadrater, som er indtegnet på figuren. Den bedste rette linje er så den linje, som minimerer det samlede areal af kvadraterne.</p>
<div id="fig-bedste_rette_linje2" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-bedste_rette_linje2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lever_du_baeredygtigt/images/bedste_rette_linje_illustration2.png" class="img-fluid figure-img" style="width:75.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-bedste_rette_linje2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figur&nbsp;9: Fem punkter og en ret linje, hvor den kvadrerede afstand fra hvert punkt ned til linjen er illustreret som arealet af et kvadrat.
</figcaption>
</figure>
</div>
<p>I app’en herunder kan du selv prøve at ændre på værdien af <span class="math inline">\(a\)</span> og <span class="math inline">\(b\)</span> og se, om du kan få kvadratsummen mindre.</p>

<meta name="viewport" content="width=device-width,initial-scale=1">
<meta charset="utf-8">
<script src="https://cdn.geogebra.org/apps/deployggb.js"></script>

<!--
Alle geogebra filer placeres i mappen _geogebra
Erstat XXX med nr på app og erstat YYY med navn på ggb-fil -->
<script>
var parameters1 = {
"id": "ggbApplet1",
"scaleContainerClass": "ggbContainer",
"prerelease":false,
"borderColor":null,
"showMenuBar":false,
"showAlgebraInput":false,
"showToolBar":false,
"showToolBarHelp":false,
"showResetIcon":true,
"enableLabelDrags":false,
"enableShiftDragZoom":true,
"enableRightClick":false,
"errorDialogsActive":false,
"useBrowserForJS":false,
"capturingThreshold":null,
"language":"da",
// use this instead of ggbBase64 to load a .ggb file
"filename":"lever_du_baeredygtigt/_geogebra/bedste_rette_linje_interaktiv.ggb",
};
// is3D=is 3D applet using 3D view, AV=Algebra View, SV=Spreadsheet View, CV=CAS View, EV2=Graphics View 2, CP=Construction Protocol, PC=Probability Calculator DA=Data Analysis, FI=Function Inspector, macro=Macros
// var views1 = {'is3D': 0,'AV': 0,'SV': 0,'CV': 0,'EV2': 0,'CP': 0,'PC': 0,'DA': 0,'FI': 0,'macro': 0};
var applet1 = new GGBApplet(parameters1, true);
</script>

<script>
window.onload = function() {
  applet1.inject('ggbApplet1');
  }
</script>

<div class="ggbContainer" style="width:100%; margin: auto">
<div id="ggbApplet1">

</div>
</div>
<p><br>
</p>
<p>Kalder vi summen af arealerne af kvadraterne for fejlen hørende til en given linje, så vil fejlen altså afhænge af tallene <span class="math inline">\(a\)</span> og <span class="math inline">\(b\)</span>, som du lige har set.</p>
<p>Lad os se på et konkret eksempel:</p>
<div class="example page-columns page-full">
<p><strong>Eksempel 2: Fejlen hørende til en linje</strong></p>
<p>Vi ser på følgende måleserie med fem punkter:</p>
<table class="table-bordered table">
<thead>
<tr class="header">
<th style="text-align: center;"><span class="math inline">\(1\)</span></th>
<th style="text-align: center;"><span class="math inline">\(3\)</span></th>
<th style="text-align: center;"><span class="math inline">\(4\)</span></th>
<th style="text-align: center;"><span class="math inline">\(6\)</span></th>
<th style="text-align: center;"><span class="math inline">\(9\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(5\)</span></td>
<td style="text-align: center;"><span class="math inline">\(7\)</span></td>
<td style="text-align: center;"><span class="math inline">\(8\)</span></td>
<td style="text-align: center;"><span class="math inline">\(11\)</span></td>
<td style="text-align: center;"><span class="math inline">\(15\)</span></td>
</tr>
</tbody>
</table>
<p>I <a href="#fig-eks2" class="quarto-xref">figur&nbsp;10</a> er punkterne indtegnet sammen med linjen med ligning <span class="math inline">\(y=2x+1\)</span>.</p>
<div id="fig-eks2" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-eks2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lever_du_baeredygtigt/images/eks2.png" class="img-fluid figure-img" style="width:75.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-eks2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figur&nbsp;10: Fem punkter og linjen med ligning <span class="math inline">\(y=2x+1\)</span>.
</figcaption>
</figure>
</div>
<p>Fejlen hørende til denne linje er</p>
<p><span class="math display">\[
\begin{aligned}
&amp;(y_1-(2 \cdot x_1 +1))^2 + (y_2-(2 \cdot x_2+1))^2 + \\
&amp;(y_3-(2 \cdot x_3+1))^2 + (y_4-(2 \cdot x_4+1))^2 + \\
&amp;(y_5-(2 \cdot x_5+1))^2 = 25
\end{aligned}
\]</span></p>
<p>hvor vi har indsat <span class="math inline">\(x\)</span>- og <span class="math inline">\(y\)</span>-værdierne for måleserien.</p>
<p>Opskriver vi fejlen helt generelt, fås <span class="math display">\[
\begin{aligned}
\textrm{fejl}(a,b) = &amp;(y_1-(a \cdot x_1 +b))^2 + \\
&amp;(y_2-(a \cdot x_2+b))^2 + \\
&amp;(y_3-(a \cdot x_3+b))^2 + \\
&amp;(y_4-(a \cdot x_4+b))^2 + \\
&amp;(y_5-(a \cdot x_5+b))^2
\end{aligned}
\]</span></p>
<p>Indsættes <span class="math inline">\(x\)</span>- og <span class="math inline">\(y\)</span>-værdierne fra måleserien og reduceres der, får vi:</p>
<p><span id="eq-fejl_eks2"><span class="math display">\[
\textrm{fejl}(a,b) = 143 a^2 + 46 ab + 5b^2 -518a-92b+484
\tag{1}\]</span></span></p>
<p>Så kan fejlen hørende til linjen <span class="math inline">\(y=2x+1\)</span> udtrykkes som funktionsværdien</p>
<p><span class="math display">\[
\textrm{fejl}(2,1) = 25.
\]</span></p>
<p>Vi skal finde minimumspunktet for funktionen <span class="math inline">\(\textrm{fejl}(a,b)\)</span>. Det vil sige, de to tal <span class="math inline">\(a\)</span> og <span class="math inline">\(b\)</span>, som gør fejlen mindst mulig. Den bedste rette linje er så <span class="math inline">\(y=ax+b\)</span>. Vi finder $a $ og <span class="math inline">\(b\)</span> med en iterativ procedure som i afsnittet <a href="../undervisningsforlob/lever_du_baeredygtigt.html#toppunkt-for-en-parabel">Toppunkt for en parabel</a>.</p>
<p>Vi kan starte således:</p>
<ul>
<li><p>Startgæt <span class="math inline">\(a=2\)</span> og <span class="math inline">\(b=1\)</span>, hvor fejlen er:</p>
<p><span class="math display">\[\textrm{fejl}(2,1) = 25\]</span></p></li>
</ul>
<p><u>Skrue på <span class="math inline">\(a\)</span>-værdien</u></p>
<ul>
<li><p>Vi prøver at skrue op for <span class="math inline">\(a\)</span>:</p>
<p><span class="math display">\[\textrm{fejl}(2.2,1) = 50.72\]</span></p>
<p>Fejlen voksede ved at skrue op for <span class="math inline">\(a\)</span>, så vi vælger i stedet at skrue ned:</p>
<p><span class="math display">\[\textrm{fejl}(1.8,1) = 10.72\]</span></p>
<p>Vi kan nu se, at det gav en mindre fejl – det vil sige en bedre linje.</p></li>
<li><p>Det nye gæt er nu <span class="math inline">\(a=1.8\)</span> og <span class="math inline">\(b=1\)</span>, hvor fejlen er:</p>
<p><span class="math display">\[\textrm{fejl}(1.8,1) = 10.72\]</span></p></li>
</ul>
<p><u>Skrue på <span class="math inline">\(b\)</span>-værdien</u></p>
<ul>
<li><p>Vi prøver at skrue op for <span class="math inline">\(b\)</span>:</p>
<p><span class="math display">\[\textrm{fejl}(1.8,1.2) = 11.08\]</span></p>
<p>Fejlen voksede ved at skrue op for <span class="math inline">\(b\)</span>, men kun ganske lidt. Vi kan så vælge, at lade <span class="math inline">\(b\)</span>-værdien være uændret eller bare skrue lidt ned for <span class="math inline">\(b\)</span>:</p>
<p><span class="math display">\[\textrm{fejl}(1.8,0.8) = 10.76\]</span> <span class="math display">\[\textrm{fejl}(1.8,0.9) = 10.69\]</span></p></li>
<li><p>Det nye gæt er nu <span class="math inline">\(a=1.8\)</span> og <span class="math inline">\(b=0.9\)</span>, hvor fejlen er:</p>
<p><span class="math display">\[\textrm{fejl}(1.8,0.9) = 10.69\]</span> På den måde kan man fortsætte.</p></li>
</ul>
</div>
<p>Det er vigtigt, at man skiftevis justerer <span class="math inline">\(a\)</span> og <span class="math inline">\(b\)</span>. Man kan ikke gøre den ene færdig først. Man vil ofte se, at den ene måske falder i starten, men når den anden så er justeret nogle gange, så begynder den måske at stige igen.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Opgave 6: Find <span class="math inline">\(a\)</span> og <span class="math inline">\(b\)</span> ved hjælp af den iterative metode
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Brug en måleserie med kun to punkter <span class="math inline">\((x_1,y_1)=(1,8)\)</span> og <span class="math inline">\((x_2,y_2)=(3,14)\)</span>. Det er klart, at den bedste rette linje må gå igennem begge punkter, og den bliver <span class="math inline">\(y=3x+5\)</span>.</p>
<p>Vi vil se, om metoden ovenfor også giver det.</p>
<ul>
<li><p>Bestem fejlen for linjen <span class="math inline">\(y=2x+4\)</span>, det vil sige tallet <span class="math inline">\(\textrm{fejl}(2,4)\)</span> for denne måleserie.</p></li>
<li><p>Bestem det generelle udtryk for fejlen, det vil sige funktionen <span class="math inline">\(\textrm{fejl}(a,b)\)</span>.</p></li>
<li><p>Brug startgættet <span class="math inline">\(a=2\)</span> og <span class="math inline">\(b=4\)</span> og den iterative metode til at finde den bedste rette linje.</p></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Opgave 7: Find <span class="math inline">\(a\)</span> og <span class="math inline">\(b\)</span> ved hjælp af den iterative metode (eget eksempel)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li>Lav selv et eksempel med tre punkter. Bestem den bedste rette linje med den iterative metode og sammenlign med resultatet fundet med lineær regression.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="træning-af-neurale-net" class="level2">
<h2 class="anchored" data-anchor-id="træning-af-neurale-net">Træning af neurale net</h2>
<p>De to eksempler <a href="../undervisningsforlob/lever_du_baeredygtigt.html#toppunkt-for-en-parabel">Toppunkt for en parabel</a> og <a href="../undervisningsforlob/lever_du_baeredygtigt.html#bedste-rette-linje">Bedste rette linje</a> illustrerer, hvordan man med en iterativ proces kan bestemme parametrene <span class="math inline">\(a\)</span> og <span class="math inline">\(b\)</span> for den bedste rette linje. Overordnet set er det den samme metode, der bruges til at træne neurale net, blot har man mange flere parametre, så det kræver meget regnekraft.</p>
<p>I afsnittet <a href="../undervisningsforlob/lever_du_baeredygtigt.html#neurale-net">Neurale net</a> så vi, at alle parametrene knyttet til forbindelserne mellem knudepunkterne i et neuralt net fastlægger den funktion, som beskriver hvordan output afhænger af input. For at få et velfungerende neuralt net skal man forsøge at vælge disse parametre, så man får det ønskede output. Det gøres på følgende måde:</p>
<p>Man skal have adgang til store mængder træningsdata, hvor man kender både input og det ønskede output. Man definerer så en fejlfunktion, som kan beskrive afvigelsen mellem de faktiske output fra det neurale net og de kendte ønskede output. Parametrene vælges, så denne fejl bliver mindst mulig.</p>
<p>Vælg en startværdi for alle parametrene i det neurale net. Herefter justerer man gradvist på alle parametrene ved at forsøge at gøre fejlen lidt mindre ved hver justering. Det fortsætter man med, indtil fejlen forhåbentlig stabiliserer sig.</p>
<p>Til sidst har man brug for noget testdata, som ikke er brugt til træningen af det neurale net, men hvor man også kender både input og det ønskede output. Det bruges til at afprøve, om det neurale net fungerer efter hensigten ved at teste, om det neurale net kan forudsige output i testedata.</p>
</section>
<section id="anvendelse-lever-du-bæredygtigt" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="anvendelse-lever-du-bæredygtigt">Anvendelse: Lever du bæredygtigt?</h2>
<p>Vi vil lave en primitiv test baseret på kunstig intelligens og et neuralt netværk, men først skal vi have indsamlet noget træningsdata og testdata.</p>
<p><img src="lever_du_baeredygtigt/images/baeredygtighed.jpg" class="img-fluid" style="float:right; margin-left: 5px;;width:40.0%"> Udgangspunktet er et spørgeskema med fire spørgsmål omhandlende aspekter af bæredygtighed, hver med fem svarmuligheder. Vi tildeler hver svarmulighed et pointtal, for eksempel -2, -1, 0, 1 og 2.</p>
<p>Et eksempel på et spørgsmål kunne være:</p>
<div class="centertext">
<p>"Hvor ofte cykler du?"</p>
</div>
<p>med følgende valgmuligheder (sæt et kryds):</p>
<table class="table-bordered table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Aldrig</th>
<th style="text-align: center;">Få gange om året</th>
<th style="text-align: center;">Få gange om måneden</th>
<th style="text-align: center;">Få gange om ugen</th>
<th style="text-align: center;">Dagligt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">X</td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
<p>Den, der besvarer spørgeskemaet, ser det ikke, men vi oversætter svarene til pointtal:</p>
<table class="table-bordered table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Aldrig</th>
<th style="text-align: center;">Få gange om året</th>
<th style="text-align: center;">Få gange om måneden</th>
<th style="text-align: center;">Få gange om ugen</th>
<th style="text-align: center;">Dagligt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">-2</td>
<td style="text-align: center;">-1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">2</td>
</tr>
</tbody>
</table>
<p>En besvarelse af spørgeskemaet giver et tal knyttet til svaret på hvert spørgsmål.</p>
<p>Som træningsdata lader vi et antal personer, som vi på forhånd ved enten prøver at leve bæredygtigt eller er ligeglade, besvare spørgeskemaet. Hvis man prøver at leve bæredygtigt, tildeles man resultatet 1, og ellers tildeles man resultatet 0.</p>
<p>Herunder er et eksempel på et opnået sæt træningsdata skrevet ind i Excel (du kan hente Excel-filen <a href="data/spgskema_traeningsdata.xlsx">her</a>):</p>
<div id="fig-traen" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-traen-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lever_du_baeredygtigt/images/spgskema.png" class="img-fluid figure-img" style="width:75.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-traen-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figur&nbsp;11: Eksempel på træningsdata.
</figcaption>
</figure>
</div>
<p>Vi vil nu bruge ovenstående træningsdata til at træne et neuralt net til at afgøre ud fra svarene på spørgeskemaet, om man lever bæredygtigt eller ej.</p>
<p>Gå ind på <a href="https://apps01.math.aau.dk/ai/neuron/">Kunstig neuron app’en</a>, hvor du kan uploade Excel-filen med træningsdata, træne et neuralt net og til sidst få oplyst de opnåede vægte, som er de parametre, der skal bruges i forbindelserne mellem knudepunkterne.</p>
<p>Gør følgende:</p>
<ul>
<li><p>Klik i "Browse…" under fanen "Data" og find Excel-filen med træningsdata og indlæs den. Tryk på "Næste".</p></li>
<li><p>Vælg under fanen "Variable", at target-variablen er "Resultat" og sæt target-værdien til 1, som blot betyder, at vi kalder det at leve bæredygtigt for succes.</p></li>
<li><p>Vælg herefter de fire spørgsmål som feature-variable. Tryk på "Næste".</p></li>
<li><p>Under fanen "Træning" sættes "Antal iterationer" til 20000, mens der ikke ændres på resten. Tryk på "Kør modellen". Med vores eksempel på træningsdata giver det følgende resultat:</p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lever_du_baeredygtigt/images/vaegte.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
<p>Grafen her (som findes til højre i app’en):</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lever_du_baeredygtigt/images/fejl_graf.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
<p>viser hvordan værdien af fejl-funktionen<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> har ændret sig efter hver justering af vægtene. Vi kan her se, at fejl-funktionen har stabiliseret sig, som ønsket.</p>
<div class="no-row-height column-margin column-container"><div id="fn2"><p><sup>2</sup>&nbsp;Fejl-funktionen kaldes også ofte for en "tabsfunktion", "error function" eller "loss function".</p></div></div><p>Med disse parametre kan vi nu lave en funktion, der ud fra svarene på spørgsmålene giver outputtet af det neurale net i form af enten tallet <span class="math inline">\(1\)</span>, hvis man lever bæredygtigt, eller tallet <span class="math inline">\(0\)</span>, hvis man ikke gør.</p>
<p>Funktionen kan illustreres således:</p>
<div id="fig-neuron" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-neuron-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../materialer/kunstige_neuroner/images/simplet_netvaerk2.png" class="img-fluid figure-img" style="width:75.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-neuron-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figur&nbsp;12: En kunstig neuron.
</figcaption>
</figure>
</div>
<p>Her lader vi <span class="math inline">\(x_1\)</span> være talværdien fra svaret på spørgsmål 1, <span class="math inline">\(x_2\)</span> være talværdien fra svaret på spørgsmål 2 og så videre. Dem ganger man med vægtene <span class="math inline">\(W_1,\ldots,w_4\)</span> fra det trænede neurale net og lægger sammen (og lægger vægten <span class="math inline">\(w_0\)</span> til):</p>
<p><span class="math display">\[
w_0 + w_1 \cdot x_1 + w_2 \cdot x_2 + w_3 \cdot x_3 + w_4 \cdot x_4
\]</span></p>
<p>Til sidst konverterer man dette tal ved at bruge sigmoid-funktionen</p>
<p><span class="math display">\[
\sigma(x) = \frac{1}{1 + \mathrm{e}^{-x}}
\]</span> som ender med at give et tal mellem <span class="math inline">\(0\)</span> og <span class="math inline">\(1\)</span>. Dette tal kan man tænke på som sandsynligheden for, om man er bæredygtig eller ej. Derfor vil man se på, om resultatet er større end <span class="math inline">\(0.5\)</span>. Hvis det er det, vil man sige at output er <span class="math inline">\(1\)</span> (svarende til at være bæredygtig), mens man vil sætte output til <span class="math inline">\(0\)</span>, hvis resultatet er mindre end <span class="math inline">\(0.5\)</span>.</p>
<p>I eksemplet ovenfor er outputtet dermed givet ved en funktion af fire variable - fordi der var fire spørgsmål:</p>
<p><span class="math display">\[
\begin{aligned}
f(x_1, x_2, x_3, x_4) = \sigma (w_0 + w_1 \cdot x_1 + w_2 \cdot x_2 + w_3 \cdot x_3 + w_4 \cdot x_4 ) = \\
\sigma (-1.08 + 1.223 \cdot x_1 + 1.446 \cdot x_2 + 0.7391 \cdot x_3 + 0.2184 \cdot x_4 )
\end{aligned}
\]</span></p>
<p>For at afprøve om det trænede neurale net, og dermed formlen, virker, skal vi indsamle noget testdata på samme måde som træningsdata.</p>
<p>Som testdata lader vi altså et antal personer som vi på forhånd ved enten prøver at leve bæredygtigt eller er ligeglade besvare spørgeskemaet. Hvis man prøver at leve bæredygtigt, tildeles man resultatet <span class="math inline">\(1\)</span>, og ellers tildeles man resultatet <span class="math inline">\(0\)</span>.</p>
<p>Her er et eksempel på testdata indtastet i Excel:</p>
<div id="fig-test" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-test-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lever_du_baeredygtigt/images/spgskema_test.png" class="img-fluid figure-img" style="width:75.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-test-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figur&nbsp;13: Eksempel på testdata.
</figcaption>
</figure>
</div>
<p>Vi kan nu se, om vi får det rigtige output:</p>
<p><span class="math display">\[
\begin{aligned}
&amp; f(1,2,2,0) \approx 0.989 &gt; 0.5 \\\\
&amp; f(0,-2,1,-2) \approx 0.025 &lt; 0.5 \\\\
&amp; f(1,2,0,0) \approx 0.954 &gt; 0.5 \\\\
\end{aligned}
\]</span></p>
<p>Outputtet bliver rigtigt i alle tre tilfælde.</p>
<p>Det ser altså ud til, at det trænede neurale net og dermed formlen kan bruges til at afgøre, om man lever bæredygtigt eller ej ud fra svarene på spørgsmålene i spørgeskemaet.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Opgave 8: Lav spørgeskema
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Lav selv et spørgeskema om bæredygtighed og indsaml træningsdata og testdata ved at få personer, der tydeligt lever bæredygtigt eller er ligeglade, til at besvare spørgeskemaet.</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Opgave 9: Træn neuralt netværk
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Træn et neuralt net til at afgøre, om man lever bæredygtigt eller ej ud fra træningsdata og opstil output-funktionen.</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Opgave 10: Testdata
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Brug output-funktionen til at undersøge, om det neurale net giver de korrekte svar på testdata.</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Opgave 11: Prædiktion
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Få andre personer til at besvare spørgeskemaet og brug output-funktionen til at afgøre, om de lever bæredygtigt eller ej (man siger, at man <em>prædikterer</em>, om de lever bæredygtigt eller ej).</p>
</div>
</div>
</div>
</section>
<section id="brug-af-kunstig-intelligens" class="level2">
<h2 class="anchored" data-anchor-id="brug-af-kunstig-intelligens">Brug af kunstig intelligens</h2>
<p>Ulempen ved at bruge kunstig intelligens er, at fortolkningen af, hvad der foregår ved træningen af et neuralt net, og dermed også fortolkningen af svarene, er mere uklar i forhold til en simpel beregning.</p>
<p>Fordelen er, at man eventuelt kan løse problemer, der ikke kan løses på anden vis, blandt andet fordi man kan modellere mere komplicerede funktioner end de lineære. Det kræver dog, når man har adgang til store mængder træningsdata af en god kvalitet.</p>


</section>


</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/aimat\.dk");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>