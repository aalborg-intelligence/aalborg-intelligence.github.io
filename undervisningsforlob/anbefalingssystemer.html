<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Du kender det sikkert godt. Du har lige set en serie på Netflix, og så anbefaler Netflix dig en ny serie, som viser sig at være spot-on! Men hvordan kan det lade sig gøre? Det kan du lære meget mere om her.">

<title>Hvad skal du se på Netflix? – AI MAT - matematikken bag magien</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../logo/SVG/Bomaerke_05_AIMAT_2024.svg" rel="icon" type="image/svg+xml">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-c9773902334eb0d2669f10110b305e83.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-Y219BCPS45"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
 
  gtag('consent', 'default', {
    'ad_storage': 'denied',
    'analytics_storage': 'denied'
  });
gtag('config', 'G-Y219BCPS45', { 'anonymize_ip': true});
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="floating nav-fixed slimcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../logo/PNG/Logo_multi_AIMAT_RGB_2024.png" alt="" class="navbar-logo light-content">
    <img src="../logo/PNG/Logo_multi_AIMAT_RGB_2024.png" alt="" class="navbar-logo dark-content">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../undervisningsforlob/index.html"> 
<span class="menu-text">Undervisningsforløb</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../materialer/index.html"> 
<span class="menu-text">Materialer</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../srp/index.html"> 
<span class="menu-text">SRP</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../apps/index.html"> 
<span class="menu-text">Apps</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">Om os</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.youtube.com/@ai-mat"> 
<span class="menu-text"><img src="../logo/YouTube/youtube-color-darkblue-icon.svg" style="height:2em"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Indhold</h2>
   
  <ul>
  <li><a href="#formål" id="toc-formål" class="nav-link active" data-scroll-target="#formål">Formål</a></li>
  <li><a href="#anbefalet-til-dig" id="toc-anbefalet-til-dig" class="nav-link" data-scroll-target="#anbefalet-til-dig">Anbefalet til dig</a></li>
  <li><a href="#en-samarbejdsbaseret-algoritme" id="toc-en-samarbejdsbaseret-algoritme" class="nav-link" data-scroll-target="#en-samarbejdsbaseret-algoritme">En samarbejdsbaseret algoritme</a></li>
  <li><a href="#en-indholdsbaseret-algoritme" id="toc-en-indholdsbaseret-algoritme" class="nav-link" data-scroll-target="#en-indholdsbaseret-algoritme">En indholdsbaseret algoritme</a></li>
  <li><a href="#samarbejdsbaserede-modeller-for-ratings" id="toc-samarbejdsbaserede-modeller-for-ratings" class="nav-link" data-scroll-target="#samarbejdsbaserede-modeller-for-ratings">Samarbejdsbaserede modeller for ratings</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Hvad skal du se på Netflix?</h1>
  <div class="quarto-categories">
    <div class="quarto-category">A-niveau</div>
    <div class="quarto-category">Kort</div>
  </div>
  </div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="callout callout-style-simple callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Caution</span>Forudsætninger og tidsforbrug
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>Lineære funktioner.</li>
<li>Lineær regression.</li>
<li>Sandsynlighedsregning.</li>
<li>Differentialregning.</li>
</ul>
<p><strong>Tidsforbrug:</strong> Ca. 2 x 90 minutter.</p>
</div>
</div>
</div>
<section id="formål" class="level3 purpose">
<h3 class="anchored" data-anchor-id="formål">Formål</h3>
<p>Formålet med dette forløb er at få en forståelse for, hvordan streamingtjenester og sociale medier kan lave individualiserede anbefalinger til sine brugere. Herunder hvordan samarbejds- og indholdsbaserede algoritmer virker.</p>
</section>
<section id="anbefalet-til-dig" class="level2">
<h2 class="anchored" data-anchor-id="anbefalet-til-dig">Anbefalet til dig</h2>
<p>Læs indledningen i <a href="../materialer/anbefalinger/anbefalinger.html">noten Anbefalet til dig</a> <em>indtil</em> afsnittet "En samarbejdsbaseret algoritme".</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../materialer/anbefalinger/images/film.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></p>
</figure>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Opgave 1: Samarbejds- og indholdsbaserede algoritmer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li>Beskriv med dine egne ord, hvad forskellen er på samarbejds- og indholdsbaserede algoritmer.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="en-samarbejdsbaseret-algoritme" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="en-samarbejdsbaseret-algoritme">En samarbejdsbaseret algoritme</h2>
<p>Læs hele afsnittet <a href="../materialer/anbefalinger/anbefalinger.html#en-samarbejdsbaseret-algoritme">En samarbejdsbaseret algoritme</a>.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Opgave 2: Online elektronikbutik
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>En online elektronikbutik har 1.000.000 kunder. Heraf har 235.476 købt en computer, 423.517 har købt en mus og 114.237 købt et tastatur, 23.127 har købt både computer og mus, mens 51.633 har købt både computer og tastatur.</p>
<ul>
<li><p>Beregn frekvensen af <span class="math inline">\(F_{\{\text{computer}\}}\)</span>, <span class="math inline">\(F_{\{\text{mus}\}}\)</span>, <span class="math inline">\(F_{\{\text{tastatur}\}}\)</span>, <span class="math inline">\(F_{\{\text{computer,mus}\}}\)</span> og <span class="math inline">\(F_{\{\text{computer, tastatur}\}}\)</span>. Hvilken vare var mest populær?</p></li>
<li><p>Beregn <span class="math inline">\(\hat{P}( F_{\text{mus}} \mid F_{\text{computer}})\)</span> og <span class="math inline">\(\hat{P}(F_{\text{tastatur}} \mid F_{\text{computer}} )\)</span>. Hvilken vare ville du anbefale til en bruger, der lige har købt en computer?</p></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Opgave 3: Film
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Se på datasættet i <a href="#tbl-data" class="quarto-xref">tabel&nbsp;1</a> herunder.</p>
<ul>
<li><p>Beregn frekvenserne af <span class="math inline">\(F_{\{\text{Blinkende Lygter}\}}\)</span>, <span class="math inline">\(F_{\{\text{Olsen-banden}\}}\)</span> og <span class="math inline">\(F_{\{\text{Blinkende Lygter, Olsen-banden}\}}\)</span>.</p></li>
<li><p>Beregn <span class="math inline">\(\hat{P}(F_{\text{Olsen-banden}}\mid F_{\text{Blinkende lygter}} )\)</span> og <span class="math inline">\(\hat{P}( F_{\text{Hævnen}}\mid F_{\text{Blinkende lygter}})\)</span>. Hvilken film ville du foreslå en bruger, der lige har set "Blinkende lygter"?</p></li>
</ul>
</div>
</div>
</div>
<div id="tbl-data" class="bordered quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table-bordered table">
<thead>
<tr class="header">
<th style="text-align: center;">Brugernummer</th>
<th style="text-align: center;">"Blinkende lygter"</th>
<th style="text-align: center;">"Olsen-banden"</th>
<th style="text-align: center;">"Hævnen"</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabel&nbsp;1: Eksempel på et datasæt med <span class="math inline">\(p=3\)</span> film og <span class="math inline">\(n=4\)</span> brugere. Hver række svarer til en bruger, hvor 1 angiver at brugeren har set filmen, mens 0 angiver at brugeren ikke har set filmen.
</figcaption>
</figure>
</div>
</section>
<section id="en-indholdsbaseret-algoritme" class="level2">
<h2 class="anchored" data-anchor-id="en-indholdsbaseret-algoritme">En indholdsbaseret algoritme</h2>
<p>I afsnittet <a href="../materialer/anbefalinger/anbefalinger.html#en-indholdsbaseret-algoritme">En indholdsbaseret algoritme</a> skal du starte med at læse underafsnittet <a href="../materialer/anbefalinger/anbefalinger.html#multipel-lineær-regression">Multipel lineær regression</a> og <a href="../materialer/anbefalinger/anbefalinger.html#flere-variable">Flere variable</a>.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Opgave 4: Den multiple regressionsmodel
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Betragt den multiple regressionsmodel for brugeren i eksempel 3 i afsnittet, som du lige har læst. Altså</p>
<p><span id="eq-modeleks"><span class="math display">\[\hat{r}= 2 - 0.02x_1 + 0.05x_2 \tag{1}\]</span></span></p>
<ul>
<li>Lad os se på film med <span class="math inline">\(x_2=0\)</span>, det vil sige film uden action.
<ul>
<li>Redegør for, at hvis vi sætter <span class="math inline">\(x_2=0\)</span> i (<a href="#eq-modeleks" class="quarto-xref">1</a>), så får vi, at <span class="math inline">\(\hat{r}\)</span> er en lineær funktion af <span class="math inline">\(x_1\)</span>.</li>
<li>Hvad er hældning og skæring i modellen?</li>
<li>Tegn den rette linje ind i et koordinatsystem.</li>
<li>Hvad sker der med ratings, når indholdet af romantik stiger?</li>
</ul></li>
<li>Prøv i stedet at sætte <span class="math inline">\(x_2=50\)</span> i modellen.
<ul>
<li>Hvad er hældning og skæring nu?</li>
<li>Tegn den tilhørende rette linje ind i samme koordinatsystem som linjen for <span class="math inline">\(x_2=0\)</span>.</li>
<li>Hvad er forskellen på de to linjer?</li>
</ul></li>
<li>Vi gør nu det samme for fastholdt <span class="math inline">\(x_1\)</span>.
<ul>
<li>Sæt <span class="math inline">\(x_1=10\)</span>, og tegn den tilhørende linje ind i et koordinatsystem med <span class="math inline">\(x_2\)</span> på <span class="math inline">\(x\)</span>-aksen.</li>
<li>Gør det samme for <span class="math inline">\(x_1=60\)</span>.</li>
<li>Hvad sker der med ratings, når andelen af action stiger?</li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Opgave 5: Ratings af film
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Vi betragter 3 features, nemlig varighed, produktionsår (regnet i forhold til år 2000), og vurdering på <a href="https://www.imdb.com/">IMDb</a>. Tre film har følgende features:</p>
<table class="table-bordered table">
<colgroup>
<col style="width: 5%">
<col style="width: 27%">
<col style="width: 15%">
<col style="width: 36%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;">"Titanic"</th>
<th style="text-align: center;">"Olsen-banden ser rødt"</th>
<th style="text-align: center;">"Jagten"</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(x_1\)</span></td>
<td style="text-align: center;">Varighed (min)</td>
<td style="text-align: center;">194</td>
<td style="text-align: center;">105</td>
<td style="text-align: center;">115</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(x_2\)</span></td>
<td style="text-align: center;">År - 2000</td>
<td style="text-align: center;">-3</td>
<td style="text-align: center;">-24</td>
<td style="text-align: center;">12</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(x_3\)</span></td>
<td style="text-align: center;">IMDb rating</td>
<td style="text-align: center;">7.9</td>
<td style="text-align: center;">7.7</td>
<td style="text-align: center;">8.3</td>
</tr>
</tbody>
</table>
<ul>
<li><p>En bruger, som foretrækker gamle film, men hader lange film, har vægtene <span class="math inline">\(p_1=-0.01\)</span>, <span class="math inline">\(p_2=-0.1\)</span> og <span class="math inline">\(p_3= 0.1\)</span> samt <span class="math inline">\(b=2.8\)</span>. Prædiktér brugerens ratings af de tre film. Hvilken film ville du anbefale brugeren?</p></li>
<li><p>En anden bruger foretrækker film af god kvalitet, men går ikke op i varighed og alder. Vedkommende har derfor præferencerne <span class="math inline">\(b=-1\)</span>, <span class="math inline">\(p_1=0\)</span>, <span class="math inline">\(p_2=0\)</span>, <span class="math inline">\(p_3=0.6\)</span>. Prædiktér brugerens ratings og anbefal en film.</p></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Opgave 6: Multipel regressionsmodel med én variabel
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Den mulitiple regressionsmodel med <span class="math inline">\(k\)</span> variable <span class="math inline">\(x_1,\ldots,x_k\)</span> har formen<br>
<span class="math display">\[ \hat{r}=b + p_1x_1 + p_2x_2 + \dotsm + p_kx_k. \]</span></p>
<ul>
<li>Gør rede for, at en multipel regressionsmodel med én variabel (<span class="math inline">\(k=1\)</span>), er det samme som en almindelig regressionsmodel, som I kender det fra gymnasieundervisningen.</li>
</ul>
</div>
</div>
</div>
<p>Læs afsnittet <a href="../materialer/anbefalinger/anbefalinger.html#estimation-af-vægte">Estimation af vægte</a>. Her påstås det blandt andet, at</p>
<p><span id="eq-partiel"><span class="math display">\[
\begin{aligned}
&amp;\frac{\partial E}{\partial p_1} = -2x_{11}(r_1-\hat{r}_1)- \dotsm -2x_{1N}(r_N-\hat{r}_N)\\ \\
&amp;\frac{\partial E}{\partial p_2} = -2x_{21}(r_1-\hat{r}_1) - \dotsm -2x_{2N}(r_N-\hat{r}_N) \\ \\
&amp;\frac{\partial E}{\partial b} = - 2(r_1-\hat{r}_1) - \dotsm  - 2(r_N-\hat{r}_N)
\end{aligned}
\tag{2}\]</span></span></p>
<p>Det skal I nu vise.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Opgave 7: Partielle afledede
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li>Vis, at de partielle afledede er som givet i (<a href="#eq-partiel" class="quarto-xref">2</a>). Bemærk, at da <span class="math inline">\(E\)</span> er en sum, kan den differentieres ledvist. Det er altså nok at vise, at <span class="math display">\[
\begin{aligned}
&amp;\frac{\partial (r_j-\hat{r}_j)^2}{\partial p_1} = -2x_{1j}(r_j-\hat{r}_j)\\
&amp;\frac{\partial (r_j-\hat{r}_j)^2}{\partial p_2} = -2x_{2j}(r_j-\hat{r}_j)  \\
&amp;\frac{\partial (r_j-\hat{r}_j)^2}{\partial b} = - 2(r_j-\hat{r}_j)
\end{aligned}
\]</span></li>
</ul>
<!-- -   Her burde de sagtens selv kunne lave noget i Excel... -->
</div>
</div>
</div>
<p>Læs afsnittet <a href="../materialer/anbefalinger/anbefalinger.html#mere-fleksible-modeller">Mere fleksible modeller</a>.</p>
</section>
<section id="samarbejdsbaserede-modeller-for-ratings" class="level2">
<h2 class="anchored" data-anchor-id="samarbejdsbaserede-modeller-for-ratings">Samarbejdsbaserede modeller for ratings</h2>
<p>I afsnittet <a href="../materialer/anbefalinger/anbefalinger.html#samarbejdsbaserede-modeller-for-ratings">Samarbejdsbaserede modeller for ratings</a> skal du læse introduktionen og afsnittet <a href="../materialer/anbefalinger/anbefalinger.html#matrixfaktorisering">Matrixfaktorisering</a> og <a href="../materialer/anbefalinger/anbefalinger.html#skæring-i-modellen">Skæring i modellen</a>.</p>
<p>Vi minder om, at den <span class="math inline">\(i\)</span>te brugers rating af <span class="math inline">\(j\)</span>te film modelleres ved</p>
<p><span id="eq-modelij"><span class="math display">\[
\hat{r}_{ij} = p_{i1}x_{1j} + p_{i2}x_{2j} + \dotsm + p_{iM}x_{Mj}
\tag{3}\]</span></span></p>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Opgave 8: Antal vægte som skal estimeres
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Antag, at en streamingtjeneste har <span class="math inline">\(n=1.000.000\)</span> brugere og et katalog på <span class="math inline">\(10.000\)</span> film.</p>
<ul>
<li><p>Hvis vi skulle estimere alle ratings <span class="math inline">\(r_{ij}\)</span> for alle kombinationer af film og bruger, hvor mange ratings skulle vi så estimere i alt?</p></li>
<li><p>Hvis vi bruger modellen (<a href="#eq-modelij" class="quarto-xref">3</a>) med <span class="math inline">\(M=5\)</span>, hvor mange vægte skal vi så estimere i alt?</p></li>
<li><p>Hvis vi skulle lave en multipel regressionsmodel for hver eneste bruger med <span class="math inline">\(M=5\)</span> features, hvor mange vægte skulle vi så bruge i alt?</p></li>
<li><p>Hvilken af de tre modeller har det mindste antal vægte?</p></li>
</ul>
</div>
</div>
</div>
<p>Læs afsnittet <a href="../materialer/anbefalinger/anbefalinger.html#estimation-af-vægte-1">Estimation af vægte</a>.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Opgave 9: Ratings
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Tre brugere har ratet tre film, som følger:</p>
<table class="table-bordered table">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">"Titanic"</th>
<th style="text-align: center;">"Ringenes Herre"</th>
<th style="text-align: center;">"Jurassic park"</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Bruger 1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">4</td>
</tr>
<tr class="even">
<td style="text-align: center;">Bruger 2</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">5</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Bruger 3</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">2</td>
</tr>
</tbody>
</table>
<p>Vi betragter en model på formen (hvor <span class="math inline">\(\hat{r}_{ij}\)</span> er den <span class="math inline">\(i\)</span>te brugers prædikterede rating af <span class="math inline">\(j\)</span>te film):</p>
<p><span id="eq-matrixfak"><span class="math display">\[
\hat{r}_{ij} = p_{i1}x_{1j} + p_{i2}x_{2j} + \dotsm + p_{iM}x_{Mj}
\tag{4}\]</span></span></p>
<p>med <span class="math inline">\(M=2\)</span> features.</p>
<p>Vi forstiller os, at vi har valgt, hvad vægtene i modellen skal være. De tre film har featurevægtene:</p>
<table class="table-bordered table">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">"Titanic"</th>
<th style="text-align: center;">"Ringenes Herre"</th>
<th style="text-align: center;">"Jurassic park"</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(x_1\)</span></td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(x_2\)</span></td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
</tbody>
</table>
<p>De tre brugere har præferencevægtene:</p>
<table class="table-bordered table">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><span class="math inline">\(p_1\)</span></th>
<th style="text-align: center;"><span class="math inline">\(p_2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Bruger 1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">Bruger 2</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Bruger 3</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">3</td>
</tr>
</tbody>
</table>
<ul>
<li>Lav en tabel over alle de prædikterede ratings <span class="math inline">\(\hat{r}_{ij}\)</span>.</li>
<li>Beregn prædiktionsfejlen <span class="math inline">\(r_{ij}-\hat{r}_{ij}\)</span> for alle de film, der faktisk er blevet ratet af brugerne (det vil sige, hvor <span class="math inline">\(r_{ij}\neq NA\)</span> i tabellen over ratings i punkt 1).</li>
<li>Beregn tabsfunktionen <span class="math inline">\(E\)</span>.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Opgave 10: Partielle afledede
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Vis, at de partielle afledede af <span class="math inline">\((r_{ij}-\hat{r}_{ij})^2\)</span> med hensyn til vægtene er givet ved formlerne (<a href="#eq-partiel1" class="quarto-xref">5</a>), (<a href="#eq-partiel2" class="quarto-xref">6</a>) og (<a href="#eq-partiel3" class="quarto-xref">7</a>) her under.</p>
</div>
</div>
</div>
<p><span id="eq-partiel1"><span class="math display">\[
\begin{aligned}
\frac{\partial }{\partial p_{im}} (r_{ij}-\hat{r}_{ij})^2 = -2 (r_{ij}-\hat{r}_{ij})x_{mj}\\
\frac{\partial }{\partial x_{mj}} (r_{ij}-\hat{r}_{ij})^2 = -2 (r_{ij}-\hat{r}_{ij})p_{im}
\end{aligned}
\tag{5}\]</span></span></p>
<p>Desuden gælder der for <span class="math inline">\(l\neq i\)</span>, at</p>
<p><span id="eq-partiel2"><span class="math display">\[
\frac{\partial }{\partial p_{lm}} (r_{ij}-\hat{r}_{ij})^2 = 0
\tag{6}\]</span></span></p>
<p>og for <span class="math inline">\(k \neq j\)</span></p>
<p><span id="eq-partiel3"><span class="math display">\[
\frac{\partial }{\partial x_{mk}} (r_{ij}-\hat{r}_{ij})^2 = 0.
\tag{7}\]</span></span></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/aimat\.dk");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>