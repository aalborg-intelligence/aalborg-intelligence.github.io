<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Hvordan får man en computer til at genkende håndskrevne tal? I dette forløb skal vi se på, hvordan man ud fra et billede af et håndskrevet tal kan lave en algortime, som kan genkende tallet.">

<title>Kan vi genkende håndskrevne tal? – AI MAT - matematikken bag magien</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../logo/SVG/Bomaerke_05_AIMAT_2024.svg" rel="icon" type="image/svg+xml">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-c9773902334eb0d2669f10110b305e83.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-Y219BCPS45"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
 
  gtag('consent', 'default', {
    'ad_storage': 'denied',
    'analytics_storage': 'denied'
  });
gtag('config', 'G-Y219BCPS45', { 'anonymize_ip': true});
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="floating nav-fixed slimcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../logo/PNG/Logo_multi_AIMAT_RGB_2024.png" alt="" class="navbar-logo light-content">
    <img src="../logo/PNG/Logo_multi_AIMAT_RGB_2024.png" alt="" class="navbar-logo dark-content">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../undervisningsforlob/index.html"> 
<span class="menu-text">Undervisningsforløb</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../materialer/index.html"> 
<span class="menu-text">Materialer</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../srp/index.html"> 
<span class="menu-text">SRP</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../apps/index.html"> 
<span class="menu-text">Apps</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">Om os</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.youtube.com/@ai-mat"> 
<span class="menu-text"><img src="../logo/YouTube/youtube-color-darkblue-icon.svg" style="height:2em"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Indhold</h2>
   
  <ul>
  <li><a href="#formål" id="toc-formål" class="nav-link active" data-scroll-target="#formål">Formål</a></li>
  <li><a href="#rgb-farvemodellen" id="toc-rgb-farvemodellen" class="nav-link" data-scroll-target="#rgb-farvemodellen">RGB-farvemodellen</a></li>
  <li><a href="#mnist-datasættet" id="toc-mnist-datasættet" class="nav-link" data-scroll-target="#mnist-datasættet">MNIST datasættet</a></li>
  <li><a href="#kan-vi-kende-forskel-på-0-og-1" id="toc-kan-vi-kende-forskel-på-0-og-1" class="nav-link" data-scroll-target="#kan-vi-kende-forskel-på-0-og-1">Kan vi kende forskel på 0 og 1?</a></li>
  <li><a href="#kan-vi-kende-forskel-på-0-og-3" id="toc-kan-vi-kende-forskel-på-0-og-3" class="nav-link" data-scroll-target="#kan-vi-kende-forskel-på-0-og-3">Kan vi kende forskel på 0 og 3?</a>
  <ul class="collapse">
  <li><a href="#vandrette-lokale-maksima" id="toc-vandrette-lokale-maksima" class="nav-link" data-scroll-target="#vandrette-lokale-maksima">Vandrette lokale maksima</a></li>
  <li><a href="#lodrette-lokale-maksima" id="toc-lodrette-lokale-maksima" class="nav-link" data-scroll-target="#lodrette-lokale-maksima">Lodrette lokale maksima</a></li>
  <li><a href="#klassificering-ved-beregning-kan-udelades" id="toc-klassificering-ved-beregning-kan-udelades" class="nav-link" data-scroll-target="#klassificering-ved-beregning-kan-udelades">Klassificering ved beregning (kan udelades)</a></li>
  </ul></li>
  <li><a href="#tre-features" id="toc-tre-features" class="nav-link" data-scroll-target="#tre-features">Tre features</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Kan vi genkende håndskrevne tal?</h1>
  <div class="quarto-categories">
    <div class="quarto-category">C-niveau</div>
    <div class="quarto-category">Kort</div>
    <div class="quarto-category">Informatik</div>
  </div>
  </div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="callout callout-style-simple callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Caution</span>Forudsætninger og tidsforbrug
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Forløbet kræver kendskab til:</p>
<ul>
<li>Deskriptiv statistik.</li>
<li>Koordinatsystemer.</li>
<li>Rette linjer.</li>
</ul>
<p><strong>Tidsforbrug:</strong> Ca. 90 minutter.</p>
</div>
</div>
</div>
<section id="formål" class="level3 purpose">
<h3 class="anchored" data-anchor-id="formål">Formål</h3>
<p>Nogle gange har man brug for, at håndskreven tekst kan digitaliseres. Det kan for eksempel være i en eksamenssituation, hvor din lærer og censor skriver din karakter på en liste, som efterfølgende skal tastes ind på en computer. Det ville være smart, hvis man kunne scanne listen eller tage et billede af den, hvorefter alle tal korrekt vil blive genkendt (så du ikke får en forkert karakter!). Dette forløb handler om, hvordan det kan gøres.</p>
</section>
<section id="rgb-farvemodellen" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="rgb-farvemodellen">RGB-farvemodellen</h2>
<p>Vi skal først se lidt på, hvordan billeder bliver repræsenteret i en computer. Prøv at finde et billede på din computer og zoom ind så meget som muligt. Du vil opdage, at billedet i virkeligheden består en masse små kvadrater, som hver især har én farve. Sådan et kvadrat kaldes for en <strong>pixel</strong>.</p>
<p>Hver pixel består af tre <strong>subpixels</strong>. Den første subpixel kan lyse <strong>R</strong>ød, den anden <strong>G</strong>røn og den trejde <strong>B</strong>lå:</p>
<div id="fig-subpixel" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-subpixel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="mnist_filer/subpixel.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:10.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-subpixel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figur&nbsp;1: Subpixel.
</figcaption>
</figure>
</div>
<p>Fordi alle farver bliver repræsenteret ved disse tre farver, taler man om en <strong>RGB</strong>-farvemodel.</p>
<p>Vi kan skrue på lysstyrken i hver af de tre subpixels. Hvis der er skruet fuldt op for farven, er værdien 255, mens helt slukket svarer til værdien<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> 0.</p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;Tallene fra 0 til 255 kan i det binære talsystem repræsenteres ved 8 bits svarende til 1 byte.</p></div></div><p>Vores øje opfatter ikke farven på de tre subpixels individuelt, men vi vil i stedet se en blandingsfarve. Hvis der for eksempel er skruet fuldt op på alle tre farver, så vil vores øje opfatte det som hvid. Det vil sige, at den pixel, som er vist i <a href="#fig-subpixel" class="quarto-xref">figur&nbsp;1</a> lyser hvid for os!</p>
<p>Skruer vi helt op for rød og blå, men slukker for grøn fås en pink farve (som kaldes for magenta):</p>
<div id="fig-magenta" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-magenta-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="mnist_filer/magenta.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:10.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-magenta-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figur&nbsp;2: Farven magenta - repræsenteret ved rgb(255,0,255).
</figcaption>
</figure>
</div>
<p>Farven skrives:</p>
<div class="centertext">
<p>rgb(255,0,255)</p>
</div>
<p>Hvis der er skruet lige meget op for den røde, grønne og blå subpixel, fås forskellige nuancer af grå. Det er der vist eksempler på her:</p>
<div id="fig-grays" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-grays-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="mnist_filer/grays.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:30.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-grays-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figur&nbsp;3: Forskellige toner af grå.
</figcaption>
</figure>
</div>
<p>Det betyder, at hvis man udelukkende er interesseret i gråskalaværdier, så kan vi nøjes med én værdi, som er den fælles værdi for rød, grøn og blå:</p>
<div id="fig-grays" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-grays-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="mnist_filer/grays2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:30.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-grays-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figur&nbsp;4: Forskellige toner af grå repræsenteret ved én værdi.
</figcaption>
</figure>
</div>
</section>
<section id="mnist-datasættet" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="mnist-datasættet">MNIST datasættet</h2>
<p>Der findes et stort datasæt – det såkaldte <a href="https://www.kaggle.com/datasets/oddrationale/mnist-in-csv?resource=download">MNIST</a><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> datasæt, hvor man har samlet 60000 håndskrevne cifre. Datasættet består af 60000 rækker, som hver repræsenterer et håndskrevet ciffer mellem <span class="math inline">\(0\)</span> og <span class="math inline">\(9\)</span>. Der er i alt 785 kolonner. Den første kolonne kaldet "label" angiver hvilket ciffer, der er tale om. Det er den værdi, som vi i sidste ende gerne vil kunne forudsige. En sådan værdi kaldes også for en <strong>targetværdi</strong>. De resterende 784 kolonner angiver gråskalaværdierne fra et <span class="math inline">\(28 \times 28\)</span> pixel billede af et håndskrevet ciffer.</p>
<div class="no-row-height column-margin column-container"><div id="fn2"><p><sup>2</sup>&nbsp;MNIST står for "Modified National Institute of Standards".</p></div></div><p>På <a href="#fig-mnist0_original" class="quarto-xref">figur&nbsp;5</a> ses et håndskrevet "0" fra MNIST datasættet.</p>
<div id="fig-mnist0_original" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-mnist0_original-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="mnist_filer/mnist_0_white_on_black.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:30.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-mnist0_original-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figur&nbsp;5: Et håndskrevet "0" fra MNIST datasættet.
</figcaption>
</figure>
</div>
<p>Bemærk, at der er skrevet med hvid på sort baggrund. Når vi i det følgende viser billederne af de håndskrevne tal, har vi valgt at vende farveskalaen om, så vi i stedet for gråskalaværdien <span class="math inline">\(x\)</span> tegner en pixel med gråskalaværdi</p>
<p><span class="math display">\[
255-x
\]</span></p>
<p>Det betyder, at vi i stedet for sort viser hvid og omvendt. Dette er illustreret på <a href="#fig-mnist0" class="quarto-xref">figur&nbsp;6</a>.</p>
<div id="fig-mnist0" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-mnist0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="mnist_filer/mnist_0_black_on_white.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:30.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-mnist0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figur&nbsp;6: Et håndskrevet "0" fra MNIST datasættet, men hvor farveskalaen er vendt om.
</figcaption>
</figure>
</div>
<p>Vi skal nu prøve, om vi ud fra de 784 gråskalaværdier kan "udvinde" nogle få, men sigende værdier, som kan bruges til at forudsige, hvilket ciffer der er på billedet. I første omgang vil vi prøve, om vi kan kende forskel på 0- og 1-taller.</p>
<p>Det første, vi vil gøre, er at lave billederne i en lavere opløsning svarende til, at billederne bliver mere pixeleret. Vi vil for eksempel lave et <span class="math inline">\(7 \times 7\)</span> pixel billede ved at inddele det oprindelige <span class="math inline">\(28 \times 28\)</span> pixel billede i <span class="math inline">\(2 \times 2\)</span> pixels, hvor vi så tager gennemsnittet af de pixelværdien. Et eksempel på det ses i <a href="#fig-pixeleret0" class="quarto-xref">figur&nbsp;7</a>:</p>
<div id="fig-pixeleret0" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-pixeleret0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="mnist_filer/pixeleret0.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-pixeleret0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figur&nbsp;7: Et billede af et 0 med en oprindelige opløsning på <span class="math inline">\(28 \times 28\)</span> pixels og det samme billede i en opløsning på <span class="math inline">\(7 \times 7\)</span> pixels.
</figcaption>
</figure>
</div>
<p>Til trods for at billedet er meget mere pixeleret, kan man faktisk stadigvæk tydeligt se konturerne af 0’et. Til sammenligning er et billede af et 1-tal vist i <a href="#fig-pixeleret1" class="quarto-xref">figur&nbsp;8</a>:</p>
<div id="fig-pixeleret1" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-pixeleret1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="mnist_filer/pixeleret1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-pixeleret1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figur&nbsp;8: Et billede af 1 med en oprindelige opløsning på <span class="math inline">\(28 \times 28\)</span> pixels og det samme billede i en opløsning på <span class="math inline">\(7 \times 7\)</span> pixels.
</figcaption>
</figure>
</div>
</section>
<section id="kan-vi-kende-forskel-på-0-og-1" class="level2">
<h2 class="anchored" data-anchor-id="kan-vi-kende-forskel-på-0-og-1">Kan vi kende forskel på 0 og 1?</h2>
<p>Idéen er, som nævnt tidligere, at vi ud fra <span class="math inline">\(7 \times 7\)</span> billederne vil udvinde nogle nye og få værdier, som kan bruges til at kende forskel på <span class="math inline">\(0\)</span>- og <span class="math inline">\(1\)</span>-tallerne. Vi vil altså gerne koge de ialt 49 pixelværdier ned til en til tre værdier, som er nok til at adskille 0 fra 1. Sådanne værdier kaldes for <strong>features</strong>.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Opgave 1: Beregning af featuers
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Det kunne godt se ud som om, at der bruges flere farvede pixels på at skrive et 0, end der bliver brugt på at skrive et 1-tal. Vi vil derfor helt enkelt udregne den gennemsnitlige pixelværdi af hele billedet.</p>
<ul>
<li>Udregne den gennemsnitlige pixelværdi for nedenstående to billeder:</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="mnist_filer/pixel_gns.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
<p>Et andet bud på en feature er helt enkelt, hvor mange pixels, der er helt hvide (det vil her sige med en pixelværdi på 0). Vi vil nemlig forvente, at et 1-tal fylder mindre end et 0, så antallet af helt hvide pixels må forventes at være større på billederne af 1-taller.</p>
<ul>
<li><p>Tæl antallet at hele hvide pixels på ovenstående to billeder.</p></li>
<li><p>Vi har nu beregnet to forskellige features for de to billeder. Er værdierne som forventet?</p></li>
<li><p>Det er klart, at den gennemsnitlige pixelværdi og antallet af helt hvide pixels hænger sammen. Forklar med ord hvilken sammenhæng, man vil forvente.</p></li>
</ul>
</div>
</div>
</div>
<p>Det bliver selvfølgelig lidt møjsommeligt at udregne disse to features for mange billeder. Derfor skal vi nu bruge en app, som gør arbejdet for dig.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Opgave 2: MNIST datasættet
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p><a href="https://apps01.math.aau.dk/ai/cifre/" target="_blank">Åbn denne app</a>. Øverst kan du vælge hvilket ciffer fra MNIST datasættet, du vil se. Dernæst kan du vælge pixelopløsning (<span class="math inline">\(7 \times 7\)</span>, <span class="math inline">\(14 \times 14\)</span> eller det oprindelige <span class="math inline">\(28 \times 28\)</span>). Herefter kan du vælge, om du vil have vist pixelværdierne på det pixelerede billede eller ej. Endelig kan du trykke på "Forrige billede" eller "Næste billede" for at bladre i de forskellige billeder fra MNIST datasættet.</p>
<ul>
<li>Start med at bladre lidt rundt blandt de forskellige cifre, så du får et indtryk af datasættet.</li>
</ul>
<p>I tabellen under det oprindelige billede, kan du se de to features "pixel_gns" og "antal_tomme", som er de to features, du udregnede i opgave 1.</p>
<ul>
<li>Det første 0 (med et id på 0) og det første 1-tal (med id på 100) svarer til de to billeder, som du regnede på i opgave 1. Kontrollér, om du har regnet rigtigt!</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Opgave 3: Download af datasæt
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Vi skal nu have downloadet et datasæt, hvor disse to features er udregnet for i alt 100 billeder af henholdsvis 0 og 1-taller.</p>
<p>Gå til fanen "Download". Her vælger du:</p>
<ul>
<li>En pixelopløsning på 7.</li>
<li>Sæt flueben ved 0 og 1.</li>
<li>Under "Hele billedet" sætter du flueben både ved "Gennemsnit" og "Antal tomme pixel".</li>
<li>Resten af fluebenene fjerner du.</li>
<li>Tryk på "Download data".</li>
</ul>
</div>
</div>
</div>
<p>Når du åbner datasættet i Excel, skulle det gerne se sådan her ud:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="mnist_filer/eks_excel.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
<p>Den første kolonne ("label") angiver, om der er tale om et billede af et 0 eller et 1-tal. Den anden kolonne ("id") er billedets id (det kan du bruge til at få vist billedet i app’en), de to sidste kolonner ("pixel_gns") og ("antal_tomme") svarer til de features, som vi beregnede i opgave 1.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Opgave 4: Boksplots
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Vi vil starte med at undersøge de to features hver for sig.</p>
<ul>
<li><p>Tegn i samme figur et boksplot af "pixel_gns" for både 0 og 1.</p></li>
<li><p>Forklar niveau- og spredningsforskelle i de to boksplots.</p></li>
<li><p>Gentag ovenstående, men for "antal_tomme".</p></li>
<li><p>Vil man kunne bruge enten "pixel_gns" eller "antal_tomme" alene til at kende forskel på 0 og 1?</p></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Opgave 5: Plot af to features
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li>Lav et punktplot med "pixel_gns" ud af <span class="math inline">\(x\)</span>-aksen og "antal_tomme" op af <span class="math inline">\(y\)</span>-aksen. Sørg for at alle punkter, som svarer til billeder af 0’er er farvet røde og alle punkter, som svarer til billeder af 1-taller er farvet blå.</li>
</ul>
<details>
<summary>
Sådan gør du i GeoGebra
</summary>
<p>Åbn datasættet i Excel og kopiere det hele over i et "Regneark" i GeoGebra (tryk på "Vis" <span class="math inline">\(\rightarrow\)</span> "Regneark").</p>
<ul>
<li>Stil dig i celle <code>E2</code> (det skulle gerne være den første tomme celle i anden række).</li>
<li>Skriv <code>(C2,D2)</code> (det skulle give dig værdien for "pixel_gns" og "antal_tomme" for det første billede).</li>
<li>Markér cellen. Tag ved den lille firkant nederst til højre og træk ned, så du får punkter for alle 200 billeder.</li>
<li>Justér på akserne på tegneblokken, så du kan se alle punkterne. Markér alle punkterne, højreklikke og trykke på "Basis". Sæt flueben ved "Fast objekt" (det sikrer, at du ikke ved en fejl kan flytte på punkterne). <em>Hvis</em> der er vist et navn ved punkterne i tegneblokken, fjerner du også fluebenet ved "Vis navn".</li>
<li>Markér alle de punkter i regnearket, som har en "label" værdi på 0. Højreklik og vælg "Egenskaber". Under fanen "Farve" vælger du rød.</li>
<li>Farv på tilsvarende måde alle punkterne med en "label" værdi på 1 blå.</li>
<li>Højreklik på tegneblokken og vælg "Tegneblok". Gå ind under fanen "xAkse". Under "Navn" skriver du "pixel gns" og tilsvarende navngiver du <span class="math inline">\(y\)</span>-aksen "antal tomme".</li>
</ul>
</details>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Opgave 6: Klassifikation baseret på en eller to features
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Vi vil starte med at undersøge, om vi kan kende forskel på 0 og 1 alene baseret på én af de to features.</p>
<p><span class="fremhaev">Gennemsnitlig pixelværdi</span></p>
<ul>
<li><p>Indtegn en lodret linje ved for eksempel at skrive <span class="math inline">\(x=20\)</span>. Hvilken lodret linje er bedst til at adskille de blå punkter fra de røde?</p></li>
<li><p>Hvor mange punkter kommer som minimum til at ligge på den forkerte side af linjen?</p></li>
<li><p>Find id’et på de punkter, som ligger på den forkerte side af linjen. Man siger, at disse punkter er blevet klassificeret forkert. Brug app’en til at få vist et billede af disse tal. Kan du forklare, hvorfor disse billeder bliver klassificeret forkert, når vi ser på pixel gennemsnittet alene?</p></li>
</ul>
<p>Klassifikationsnøjagtigheden (<strong>CA</strong> for <em>classification accuracy</em> på engelsk) angiver hvor stor en procentdel af data, som er blevet klassificeret korrekt.</p>
<ul>
<li>Udregn klassifikationsnøjagtigheden.</li>
</ul>
<p><span class="fremhaev">Antal hvide pixels</span></p>
<p>Vi vil nu undersøge, hvor mange billeder vi kan klassificere korrekt, ved kun at se på antallet af hvide pixels i billedet.</p>
<ul>
<li><p>Indtegn en vandret linje ved for eksempel at skrive <span class="math inline">\(y=20\)</span>.</p></li>
<li><p>Svar på de samme spørgsmål som ovenfor, men nu baseret på den vandrette linje.</p></li>
</ul>
<p><span class="fremhaev">Begge features</span></p>
<p>Til sidst vil vi prøve at undersøge, om vi kan gøre det bedre ved at bruge begge features.</p>
<ul>
<li><p>Indtegn en ret linje i koordinatsystemet.</p></li>
<li><p>Svar på de samme spørgsmål som ovenfor, men nu baseret på den generelle rette linje.</p></li>
</ul>
</div>
</div>
</div>
<p>I opgave 6 ovenfor kom du formentlig frem til, at hvis vi alene skal adskille 0’er fra 1-taller, så er det faktisk nok at tælle antallet af hvide pixels i billedet! Gør vi det, kan vi med vores træningsdata få en klassifikationsnøjagtighed på <span class="math inline">\(98.5\%\)</span>.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Opgave 7: Hjælper det med højere opløsning? (valgfri)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li>Undersøg, om du kan få en højere klassifikationsnøjagtighed ved at bruge en pixelopløsning på <span class="math inline">\(14 \times 14\)</span> eller <span class="math inline">\(28 \times 28\)</span> pixels.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="kan-vi-kende-forskel-på-0-og-3" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="kan-vi-kende-forskel-på-0-og-3">Kan vi kende forskel på 0 og 3?</h2>
<p>Det går jo strygende! Tæl antallet af hvide pixels i billedet, og du kan kende forskel på 0 og 1. Men hvad nu, hvis vi vil kende forskel på 0 og 3. Går det mon lige så nemt? Et eksempel på et håndskrevet 0 og 3-tal er vist i <a href="#fig-pixel03" class="quarto-xref">figur&nbsp;9</a>.</p>
<div id="fig-pixel03" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-pixel03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="mnist_filer/pixel03.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-pixel03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figur&nbsp;9: Et billede af et håndskrevet 0 og 3-tal med en opløsning på <span class="math inline">\(28 \times 28\)</span> pixels.
</figcaption>
</figure>
</div>
<p>Lad os prøve igen med de to features: gennemsnitlig pixelværdi og antal hvide pixels.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Opgave 8: Download af nyt datasæt
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Brug igen <a href="https://apps01.math.aau.dk/ai/cifre/" target="_blank">app’en</a>, som viser MNIST datasættet.</p>
<ul>
<li><p>Start med at bladre lidt rundt blandt 3-tallerne, så du får en fornemmelse for, hvordan de er skrevet.</p></li>
<li><p>Download et datasæt bestående af 0 og 3-taller i en pixelopløsning på <span class="math inline">\(7 \times 7\)</span> pixels.</p></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Opgave 9: Punktplot
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><p>Lav et punktplot af de to features (gennemsnitlig pixelværdi og antal hvide pixels), som du gjorde det i opgave 5. Farv alle de punkter, som svarer til billeder af 0 røde, og farv alle de punkter, som svarer til billeder af 3-taller grønne.</p></li>
<li><p>Kan du på nogen måde indlægge en linje i dette plot, som på fornuftig vis kan bruges til at adskille de røde punkter fra de grønne?</p></li>
</ul>
</div>
</div>
</div>
<p>Det er ret tydeligt, at den gennemsnitlige pixelværdi og antallet af hvide pixels i billedet på ingen måde kan bruges til at kende forskel på 0 og 3. Det skyldes, at man åbenbart bruger cirka lige meget "blyantsfarve" på at skrive 0, som man gør på at skrive 3. Det viser med al tydelighed, at de features, man vælger, er fuldstændig afhængig af det klassifikationsproblem, som man står med. To features kan være formidable til ét klassifikationsproblem (at kende forskel på 0 og 1), mens de er elendige til at andet klassifikationsproblem (at kende forskel på 0 og 3). Det betyder, at vi må på jagt efter nye features!</p>
<section id="vandrette-lokale-maksima" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="vandrette-lokale-maksima">Vandrette lokale maksima</h3>
<p>På <a href="#fig-pixel03_7x7" class="quarto-xref">figur&nbsp;10</a> ses et billede af et håndskrevet 0 og 3-tal i en opløsning på <span class="math inline">\(7 \times 7\)</span> pixels, og vi skal prøve at finde nogle karakteristika ved de to billeder, som kan bruges til at adskille dem.</p>
<div id="fig-pixel03_7x7" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-pixel03_7x7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="mnist_filer/pixel03_7x7.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-pixel03_7x7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figur&nbsp;10: Et billede af et håndskrevet 0 og 3-tal med en opløsning på <span class="math inline">\(7 \times 7\)</span> pixels.
</figcaption>
</figure>
</div>
<p>På <a href="#fig-pixel03_7x7_vandret" class="quarto-xref">figur&nbsp;13</a> har vi lagt et vandret vindue ind over en række af pixels på de to billeder. Vi vil her tælle, hvor mange gange pixelværdierne "topper". En sådan "top" kalder vi for et lokalt maksimum. På billedet af 0, kan vi se, at der er to lokale maksima, mens der på billedet af 3-tallet kun er ét lokalt maksimum. Hvis vi ser på de vandrette pixelværdier på et billede af et 0, vil vi i "toppen" og "bunden" af 0’et forvente ét lokalt maksimum, men vi i mange af de vandrette vinduer i midten af 0’et vil tænke, at der ofte vil være to lokale maksima. Dette er illustreret på <a href="#fig-lok-max0_vandret" class="quarto-xref">figur&nbsp;11</a>.</p>
<div id="fig-lok-max0_vandret" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-lok-max0_vandret-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="mnist_filer/lok-max0_vandret.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-lok-max0_vandret-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figur&nbsp;11: Antallet af vandrette lokale maksima på et billede af et håndskrevet 0.
</figcaption>
</figure>
</div>
<p>Ser vi derimod på vandrette pixelværdier på et billede af et 3-tal, vil der både være ét og to lokale maksima, som illustreret på <a href="#fig-lok-max3_vandret" class="quarto-xref">figur&nbsp;12</a>.</p>
<div id="fig-lok-max3_vandret" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-lok-max3_vandret-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="mnist_filer/lok-max3_vandret.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-lok-max3_vandret-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figur&nbsp;12: Antallet af vandrette lokale maksima på et billede af et håndskrevet 3-tal.
</figcaption>
</figure>
</div>
<p>Idéen med at tælle antallet af vandrette lokale maksimaer baseret på pixelværdi er illustreret i <a href="#fig-pixel03_7x7_vandret" class="quarto-xref">figur&nbsp;13</a>. For de to vandrette vinduer, som er lagt ind på billedet, kan vi se, at 0’et har to vandrette maksima, mens 3-tallet har ét.</p>
<div id="fig-pixel03_7x7_vandret" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-pixel03_7x7_vandret-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="mnist_filer/pixel03_7x7_vandret.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-pixel03_7x7_vandret-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figur&nbsp;13: Et billede af et håndskrevet 0 og 3-tal med et vandret vindue indlagt.
</figcaption>
</figure>
</div>
</section>
<section id="lodrette-lokale-maksima" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="lodrette-lokale-maksima">Lodrette lokale maksima</h3>
<p>Lægger vi derimod et lodret vindue ind, vil der på et 0 typisk være ét eller to lokale maksima (se <a href="#fig-lok-max0_lodret" class="quarto-xref">figur&nbsp;14</a>).</p>
<div id="fig-lok-max0_lodret" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-lok-max0_lodret-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="mnist_filer/lok-max0_lodret.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-lok-max0_lodret-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figur&nbsp;14: Antallet af lodrette lokale maksima på et billede af et håndskrevet 0.
</figcaption>
</figure>
</div>
<p>På et 3-tal kan være derimod være mellem en og tre lokal maksima (se <a href="#fig-lok-max3_lodret" class="quarto-xref">figur&nbsp;15</a>).</p>
<div id="fig-lok-max3_lodret" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-lok-max3_lodret-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="mnist_filer/lok-max3_lodret.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-lok-max3_lodret-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figur&nbsp;15: Antallet af lodrette lokale maksima på et billede af et håndskrevet 3.
</figcaption>
</figure>
</div>
<p>Princippet baseret på pixelværdier er illustreret i <a href="#fig-pixel03_7x7_lodret" class="quarto-xref">figur&nbsp;16</a>.</p>
<div id="fig-pixel03_7x7_lodret" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-pixel03_7x7_lodret-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="mnist_filer/pixel03_7x7_lodret.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-pixel03_7x7_lodret-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figur&nbsp;16: Et billede af et håndskrevet 0 og 2-tal med et lodret vindue indlagt.
</figcaption>
</figure>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Opgave 10: Vandrette og lodrette lokale maksima
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="mnist_filer/pixel03_7x7.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
<p>Med udgangspunkt i ovenstående billede af et 0 og et 3-tal skal du:</p>
<ul>
<li><p>Bestem antallet af lokale maksima i alle vandrette rækker.</p></li>
<li><p>Udregn det gennemsnitlige antal vandrette lokale maksima.</p></li>
<li><p>Bestem det største antal lokale maksima i alle vandrette rækker.</p></li>
<li><p>Bestem antallet af lokale maksima i alle lodrette rækker.</p></li>
<li><p>Udregn det gennemsnitlige antal lodrette lokale maksima.</p></li>
<li><p>Bestem det største antal lokale maksima i alle lodrette rækker.</p></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Opgave 11: Vandrette og lodrette lokale maksima
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Brug igen <a href="https://apps01.math.aau.dk/ai/cifre/" target="_blank">app’en</a>. Sæt under "Features" flueben ved "Vis lodrette lokale maksima" og "Vis vandrette lokale maksima".</p>
<p>Billederne fra opgave 10 har id 0 og 300.</p>
<ul>
<li>Kontroller ved hjælp af app’en dit resultat fra opgave 10.</li>
</ul>
<p>Vælg nu en opløsning på <span class="math inline">\(28 \times 28\)</span> pixels og sæt under "Features" flueben ved "Vis lodrette lokale maksima" og "Vis vandrette lokale maksima.”</p>
<ul>
<li><p>Se på de første ti billeder af håndskrevne 0’er. Er antallet af vandrette og lodrette lokale maksima som forventet? Hvis ikke – kan du forklare hvorfor?</p></li>
<li><p>Gentag ovenstående men se nu på de første ti billeder af håndskrevne 3-taller.</p></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Opgave 12: Download af data
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>I det følgende vælger vi, at arbejde med en opløsning på <span class="math inline">\(28 \times 28\)</span> pixels, så vi får et lidt mere finkornet billede at arbejde videre med.</p>
<p>Under fanen "Download data" vælger du derfor:</p>
<ul>
<li>En pixel-opløsning på 28.</li>
<li>Under "Tal" sætter du flueben ved 0 og 3.</li>
<li>I det følgende sætter du flueben ved alle seks features.</li>
<li>Tryk på "Download data".</li>
</ul>
</div>
</div>
</div>
<p>I opgave 11 så vi, at de håndskrevne tal ikke altid helt opfører sig, som vi kunne forvente i forhold til antallet af lodrette og vandrette lokale maksima. De er simpelthen nogle gange skrevet lidt skørt, så der enten er flere eller færre lokale maksima end forventet. Men det kunne jo godt være, at der vil være information at hente, hvis vi ser på de gennemsnitlige værdier af de lodrette og vandrette lokale maksima. Det prøver vi i næste opgave.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Opgave 13: Plot af gennemsnitsværdier
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li>Lav et punktplot med "lodret_gns" ud af <span class="math inline">\(x\)</span>-aksen og "vandret_gns" op af <span class="math inline">\(y\)</span>-aksen. Sørg for at alle punkter, som svarer til billeder af 0’er repræsenteres ved røde krydser og alle punkter, som svarer til billeder af 3-taller repræsenteres ved grønne cirkler (det er for bedre at kunne se, at nogle af punkterne ligger oveni hinanden).</li>
</ul>
<details>
<summary>
Sådan gør du i GeoGebra
</summary>
<p>Åbn datasættet i Excel og kopiere det hele over i et "Regneark" i GeoGebra (tryk på "Vis" <span class="math inline">\(\rightarrow\)</span> "Regneark").</p>
<ul>
<li>Stil dig i celle <code>I2</code> (det skulle gerne være den første tomme celle i anden række).</li>
<li>Skriv <code>(C2,E2)</code> (det skulle give dig værdien for "lodret_gns" og "vandret_gns" for det første billede).</li>
<li>Markér cellen. Tag ved den lille firkant nederst til højre og træk ned, så du får punkter for alle 200 billeder.</li>
<li>Justér på akserne på tegneblokken, så du kan se alle punkterne. Markér alle punkterne, højreklikke og trykke på "Basis". Sæt flueben ved "Fast objekt" (det sikrer, at du ikke ved en fejl kan flytte på punkterne). <em>Hvis</em> der er vist et navn ved punkterne i tegneblokken, fjerner du også fluebenet ved "Vis navn".</li>
<li>Markér alle de punkter i regnearket, som har en "label" værdi på 0. Højreklik og vælg "Egenskaber". Under fanen "Farve" vælger du rød. Under fanen "Stil" vælger du under "Punktmarkering" et kryds.</li>
<li>Farv på tilsvarende måde alle punkterne med en "label" værdi på 3 grønne og vælg en cirkel som punktmarkering.</li>
<li>Højreklik på tegneblokken og vælg "Tegneblok". Gå ind under fanen "xAkse". Under "Navn" skriver du "lodret gns" og tilsvarende navngiver du <span class="math inline">\(y\)</span>-aksen "vandret gns".</li>
</ul>
</details>
<ul>
<li><p>Sammenlign med det punktplot, som du lavede i opgave 9. Egner de to nye features sig bedre til at kende forskel på 0’er og 3-taller?</p></li>
<li><p>Indtegn i dit (nye) punktplot en ret linje, som så godt som muligt kan adskille de røde krydser fra de grønne cirkler. Nedskriv ligningen for denne linje.</p></li>
<li><p>Udvælg et 0 og et 3-tal, som ligger "på den forkerte" side af din linje og som vi altså har svært ved at kende forskel på. Find id’et på cifret og slå det op i app’en. Kan du ud fra billedet forklare, hvorfor det er svært at kende forskel?</p></li>
<li><p>Tæl (så godt som muligt – der kan være punkter, som ligger oveni hinanden) hvor mange cifre, som bliver klassificeret forkert, og udregne på den baggrund en klassifikationsnøjagtighed.</p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="klassificering-ved-beregning-kan-udelades" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="klassificering-ved-beregning-kan-udelades">Klassificering ved beregning (kan udelades)</h3>
<p>Det er desværre ikke muligt præcist at tælle, hvor mange cifre der er klassificeret forkert, fordi nogle af punkterne ligger oveni hinanden. Men vi kan heldigvis <em>beregne</em> om et punkt ligger over eller under linjen. Det gøres ved at betragte den lodrette forskel fra et punkt og ned til linjen<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>.</p>
<div class="no-row-height column-margin column-container"><div id="fn3"><p><sup>3</sup>&nbsp;Med mindre skillelinjen er lodret!</p></div></div><p>Dette er illustreret i <a href="#fig-lodret_afstand" class="quarto-xref">figur&nbsp;17</a>:</p>
<div id="fig-lodret_afstand" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-lodret_afstand-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ALS_filer/lodret_afstand.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:75.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-lodret_afstand-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figur&nbsp;17: Beregning af den lodrette forskel fra et punkt til en linje.
</figcaption>
</figure>
</div>
<p>Den lodrette forskel fra punktet <span class="math inline">\(P(x_1,y_1)\)</span> ned til linjen med ligning <span class="math inline">\(y= a \cdot x + b\)</span> må være (se <a href="#fig-lodret_afstand" class="quarto-xref">figur&nbsp;17</a>):</p>
<p><span class="math display">\[
y_1 - (a \cdot x_1 + b)
\]</span> Hvis denne forskel er positiv ligger punktet over linjen og omvendt, hvis forskellen er negativ.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Opgave 14: Klassificering ved beregning (kan springes over)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><p>Brug ligningen for den ligning du fandt i opgave 13. Hvis din ligning er på formen <span class="math inline">\(ax+by+c=0\)</span>, så start med at isolere <span class="math inline">\(y\)</span>.</p></li>
<li><p>For hvert punkt i dit punktplot skal du udregne den lodrette forskel fra punktet til din linje.</p></li>
<li><p>Lav nu en klassificering ved hjælp af fortegnet på den beregnede forskel.</p></li>
</ul>
<details>
<summary>
Sådan gør du i GeoGebra
</summary>
<p>Hvis du i kolonne <code>J</code> har udregnet den lodrette forskel, så vil vi i kolonne <code>K</code> skrive et 1-tal, hvis det tilhørende punkt er klassificeret korrekt og 0 ellers. Det gør sådan her:</p>
<p><span class="fremhaev">De røde punkter</span></p>
<ul>
<li>Skriv i celle <code>K2</code> følgende: <code>=Hvis(J2 ≥ 0, 1, 0)</code>. Det betyder, at der skrives 1 i celle <code>K2</code>, hvis forskellen i <code>J2</code> er positiv (eller 0) og ellers skrives der 0.</li>
</ul>
<p>For alle de grønne punkter er det lige omvendt:</p>
<p><span class="fremhaev">De grønne punkter</span></p>
<ul>
<li>Skriv i celle <code>K102</code> (som nok er den første celle for de grønne pnkter) følgende: <code>=Hvis(J102 &lt; 0, 1, 0)</code>. Det betyder, at der skrives 1 i celle <code>K102</code>, hvis forskellen i <code>J102</code> er negativ og ellers skrives der 0.</li>
</ul>
<p><span class="fremhaev">Alle punkter</span></p>
<ul>
<li>Tæl nu først det samlede antal korrekt klassificeret cifre. Du kan med fordel blot bruge <code>SUM(K2:K201)</code>. Tæl dernæst antal forkert klassificeret cifre.</li>
</ul>
</details>
</div>
</div>
</div>
</section>
</section>
<section id="tre-features" class="level2">
<h2 class="anchored" data-anchor-id="tre-features">Tre features</h2>
<p>Du har formentlig opdaget, at de to nye features ikke er helt tossede i forhold til at kende forskel på 0’ere og 3-taller, men at der også er nogle cifre, som vi ikke kan kende forskel på baseret på disse to features. Vi vil derfor prøve at tilføje en tredje feature og se, om vi kan få en højere klassifikationsnøjagtighed.</p>
<p>Ser vi på <a href="#fig-lok-max0_vandret" class="quarto-xref">figur&nbsp;11</a> og <strong>?@fig-lok-max1_vandret</strong> kan vi se, at både 0’er og 3-taller typisk har mellem en og to vandrette lokale maksima. Derimod illustrerer <a href="#fig-lok-max0_lodret" class="quarto-xref">figur&nbsp;14</a> og <strong>?@fig-lok-max1_lodret</strong>, at 0’er også typisk har mellem en og to lodrette lokale maksima, mens 3-taller typisk kan have op til tre lodrette lokale maksima. Vi vil derfor som en tredje feature bruge det <strong>maksimale</strong> antal lodrette lokale maksima. Her vil 0’ere typisk være karakteriseret ved at det maksimale antal lodrette lokale maksima vil være to, mens det tilsvarende tal for 3-taller vil være tre.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Opgave 15: Plot af tre features
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li>Lav et punktplot med "lodret_gns" ud af <span class="math inline">\(x\)</span>-aksen, "vandret_gns" op af <span class="math inline">\(y\)</span>-aksen og "lodret_max" op af <span class="math inline">\(z\)</span>-aksen. Sørg for at alle punkter, som svarer til billeder af 0’er farves røde og alle punkter, som svarer til billeder af 3-taller farves grønne.</li>
</ul>
<details>
<summary>
Sådan gør du i GeoGebra
</summary>
<p>Åbn datasættet i Excel og kopiere det hele over i et "Regneark" i GeoGebra (tryk på "Vis" <span class="math inline">\(\rightarrow\)</span> "Regneark").</p>
<ul>
<li>Gør som i opgave 13, men skriv i stedet i celle <code>I2</code> følgende: <code>(C2,E2,D2)</code> (det skulle give dig værdien for "lodret_gns", "vandret_gns" og "lodret max" for det første billede).</li>
<li>Udfyld for alle 200 cifre og farv igen punkterne (vær opmærksom på at man i 3D-plot ikke kan vælge punktmarkering).</li>
<li>Vælg "Vis" <span class="math inline">\(\rightarrow\)</span> "3D Grafik"</li>
</ul>
</details>
<ul>
<li><p>Sammenlign med det punktplot, som du lavede i opgave 9. Egner de to nye features sig bedre til at kende forskel på 0’er og 3-taller?</p></li>
<li><p>Indtegn i dit (nye) punktplot en ret linje, som så godt som muligt kan adskille de røde krydser fra de grønne cirkler. Nedskriv ligningen for denne linje.</p></li>
<li><p>Udvælg et 0 og et 3-tal, som ligger "på den forkerte" side af din linje og som vi altså har svært ved at kende forskel på. Find id’et på cifret og slå det op i app’en. Kan du ud fra billedet forklare, hvorfor det er svært at kende forskel?</p></li>
<li><p>Tæl (så godt som muligt – der kan være punkter, som ligger oveni hinanden) hvor mange cifre, som bliver klassificeret forkert, og udregne på den baggrund en klassifikationsnøjagtighed.</p></li>
</ul>
</div>
</div>
</div>


</section>


</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/aimat\.dk");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>